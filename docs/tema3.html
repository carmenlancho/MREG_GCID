<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Ingeniería de características: transformaciones de variables e interacciones – Modelos de Regresión</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./tema4.html" rel="next">
<link href="./tema2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-47f49dbd332796c94643f01021c20255.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="estilos_html.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tema3.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ingeniería de características: transformaciones de variables e interacciones</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelos de Regresión</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción a los modelos de regresión</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">El modelo de regresión lineal simple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">El modelo de regresión lineal múltiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ingeniería de características: transformaciones de variables e interacciones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Selección de variables, regularización y validación</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos de regresión generalizada</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusiones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Conclusiones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografía</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#transformaciones-de-variables-propósitos-y-aplicaciones" id="toc-transformaciones-de-variables-propósitos-y-aplicaciones" class="nav-link active" data-scroll-target="#transformaciones-de-variables-propósitos-y-aplicaciones"><span class="header-section-number">4.1</span> Transformaciones de variables: propósitos y aplicaciones</a>
  <ul class="collapse">
  <li><a href="#diagnóstico-cuándo-transformar" id="toc-diagnóstico-cuándo-transformar" class="nav-link" data-scroll-target="#diagnóstico-cuándo-transformar"><span class="header-section-number">4.1.1</span> Diagnóstico: ¿Cuándo transformar?</a></li>
  </ul></li>
  <li><a href="#escalado-y-normalización-preparando-variables-para-el-análisis" id="toc-escalado-y-normalización-preparando-variables-para-el-análisis" class="nav-link" data-scroll-target="#escalado-y-normalización-preparando-variables-para-el-análisis"><span class="header-section-number">4.2</span> Escalado y normalización: preparando variables para el análisis</a>
  <ul class="collapse">
  <li><a href="#estandarización-z-score" id="toc-estandarización-z-score" class="nav-link" data-scroll-target="#estandarización-z-score"><span class="header-section-number">4.2.1</span> Estandarización (Z-Score)</a></li>
  <li><a href="#normalización-min-max" id="toc-normalización-min-max" class="nav-link" data-scroll-target="#normalización-min-max"><span class="header-section-number">4.2.2</span> Normalización Min-Max</a></li>
  <li><a href="#escalado-robusto" id="toc-escalado-robusto" class="nav-link" data-scroll-target="#escalado-robusto"><span class="header-section-number">4.2.3</span> Escalado robusto</a></li>
  </ul></li>
  <li><a href="#catálogo-de-transformaciones-según-el-propósito" id="toc-catálogo-de-transformaciones-según-el-propósito" class="nav-link" data-scroll-target="#catálogo-de-transformaciones-según-el-propósito"><span class="header-section-number">4.3</span> Catálogo de transformaciones según el propósito</a>
  <ul class="collapse">
  <li><a href="#transformaciones-para-linearizar-relaciones" id="toc-transformaciones-para-linearizar-relaciones" class="nav-link" data-scroll-target="#transformaciones-para-linearizar-relaciones"><span class="header-section-number">4.3.1</span> Transformaciones para linearizar relaciones</a></li>
  <li><a href="#transformaciones-para-estabilizar-la-varianza" id="toc-transformaciones-para-estabilizar-la-varianza" class="nav-link" data-scroll-target="#transformaciones-para-estabilizar-la-varianza"><span class="header-section-number">4.3.2</span> Transformaciones para estabilizar la varianza</a></li>
  <li><a href="#transformaciones-para-normalizar-residuos-y-controlar-outliers" id="toc-transformaciones-para-normalizar-residuos-y-controlar-outliers" class="nav-link" data-scroll-target="#transformaciones-para-normalizar-residuos-y-controlar-outliers"><span class="header-section-number">4.3.3</span> Transformaciones para normalizar residuos y controlar outliers</a></li>
  </ul></li>
  <li><a href="#transformación-de-box-cox" id="toc-transformación-de-box-cox" class="nav-link" data-scroll-target="#transformación-de-box-cox"><span class="header-section-number">4.4</span> Transformación de Box-Cox</a>
  <ul class="collapse">
  <li><a href="#definición-matemática" id="toc-definición-matemática" class="nav-link" data-scroll-target="#definición-matemática"><span class="header-section-number">4.4.1</span> Definición matemática</a></li>
  <li><a href="#propósito-y-ventajas" id="toc-propósito-y-ventajas" class="nav-link" data-scroll-target="#propósito-y-ventajas"><span class="header-section-number">4.4.2</span> Propósito y ventajas</a></li>
  <li><a href="#limitaciones-importantes" id="toc-limitaciones-importantes" class="nav-link" data-scroll-target="#limitaciones-importantes"><span class="header-section-number">4.4.3</span> Limitaciones importantes</a></li>
  </ul></li>
  <li><a href="#tratamiento-de-variables-categóricas" id="toc-tratamiento-de-variables-categóricas" class="nav-link" data-scroll-target="#tratamiento-de-variables-categóricas"><span class="header-section-number">4.5</span> Tratamiento de variables categóricas</a>
  <ul class="collapse">
  <li><a href="#principios-de-codificación-categórica" id="toc-principios-de-codificación-categórica" class="nav-link" data-scroll-target="#principios-de-codificación-categórica"><span class="header-section-number">4.5.1</span> Principios de codificación categórica</a></li>
  <li><a href="#codificación-one-hot-variables-nominales" id="toc-codificación-one-hot-variables-nominales" class="nav-link" data-scroll-target="#codificación-one-hot-variables-nominales"><span class="header-section-number">4.5.2</span> Codificación One-Hot (variables nominales)</a></li>
  <li><a href="#codificación-ordinal-variables-ordinales" id="toc-codificación-ordinal-variables-ordinales" class="nav-link" data-scroll-target="#codificación-ordinal-variables-ordinales"><span class="header-section-number">4.5.3</span> Codificación Ordinal (variables ordinales)</a></li>
  <li><a href="#comparación-directa-ordinal-vs-one-hot-encoding" id="toc-comparación-directa-ordinal-vs-one-hot-encoding" class="nav-link" data-scroll-target="#comparación-directa-ordinal-vs-one-hot-encoding"><span class="header-section-number">4.5.4</span> Comparación directa: Ordinal vs One-Hot Encoding</a></li>
  </ul></li>
  <li><a href="#interacciones-entre-variables" id="toc-interacciones-entre-variables" class="nav-link" data-scroll-target="#interacciones-entre-variables"><span class="header-section-number">4.6</span> Interacciones entre variables</a>
  <ul class="collapse">
  <li><a href="#interacciones-entre-variables-continuas" id="toc-interacciones-entre-variables-continuas" class="nav-link" data-scroll-target="#interacciones-entre-variables-continuas"><span class="header-section-number">4.6.1</span> Interacciones entre variables continuas</a></li>
  <li><a href="#interacciones-entre-variables-categóricas" id="toc-interacciones-entre-variables-categóricas" class="nav-link" data-scroll-target="#interacciones-entre-variables-categóricas"><span class="header-section-number">4.6.2</span> Interacciones entre variables categóricas</a></li>
  <li><a href="#interacciones-mixtas-continua-categórica" id="toc-interacciones-mixtas-continua-categórica" class="nav-link" data-scroll-target="#interacciones-mixtas-continua-categórica"><span class="header-section-number">4.6.3</span> Interacciones mixtas (continua × categórica)</a></li>
  <li><a href="#identificación-y-detección-de-interacciones" id="toc-identificación-y-detección-de-interacciones" class="nav-link" data-scroll-target="#identificación-y-detección-de-interacciones"><span class="header-section-number">4.6.4</span> Identificación y detección de interacciones</a></li>
  <li><a href="#consideraciones-prácticas-y-limitaciones" id="toc-consideraciones-prácticas-y-limitaciones" class="nav-link" data-scroll-target="#consideraciones-prácticas-y-limitaciones"><span class="header-section-number">4.6.5</span> Consideraciones prácticas y limitaciones</a></li>
  </ul></li>
  <li><a href="#ingeniería-de-características-avanzada-combinaciones-ratios-y-transformaciones" id="toc-ingeniería-de-características-avanzada-combinaciones-ratios-y-transformaciones" class="nav-link" data-scroll-target="#ingeniería-de-características-avanzada-combinaciones-ratios-y-transformaciones"><span class="header-section-number">4.7</span> Ingeniería de características avanzada: combinaciones, ratios y transformaciones</a>
  <ul class="collapse">
  <li><a href="#combinaciones-lineales-y-no-lineales" id="toc-combinaciones-lineales-y-no-lineales" class="nav-link" data-scroll-target="#combinaciones-lineales-y-no-lineales"><span class="header-section-number">4.7.1</span> Combinaciones lineales y no lineales</a></li>
  <li><a href="#ratios-y-proporciones-como-features" id="toc-ratios-y-proporciones-como-features" class="nav-link" data-scroll-target="#ratios-y-proporciones-como-features"><span class="header-section-number">4.7.2</span> Ratios y proporciones como features</a></li>
  <li><a href="#tratamiento-de-variables-colineales-mediante-feature-engineering" id="toc-tratamiento-de-variables-colineales-mediante-feature-engineering" class="nav-link" data-scroll-target="#tratamiento-de-variables-colineales-mediante-feature-engineering"><span class="header-section-number">4.7.3</span> Tratamiento de variables colineales mediante feature engineering</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-tema3" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ingeniería de características: transformaciones de variables e interacciones</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>En la práctica del análisis de datos, los datos en su estado bruto raramente están en la forma óptima para el modelado estadístico. La <strong>ingeniería de características</strong> es el proceso fundamental que transforma, combina y crea variables para maximizar la capacidad predictiva y la interpretabilidad de nuestros modelos <span class="citation" data-cites="kuhn2019feature zheng2018feature">(<a href="references.html#ref-kuhn2019feature" role="doc-biblioref">Kuhn y Johnson 2019</a>; <a href="references.html#ref-zheng2018feature" role="doc-biblioref">Zheng y Casari 2018</a>)</span>.</p>
<p>Este proceso abarca tres áreas principales que exploraremos en profundidad:</p>
<p><strong>Transformaciones de variables</strong>: Las transformaciones matemáticas nos permiten abordar múltiples problemas simultaneamente: linearizar relaciones no lineales, estabilizar la varianza (heterocedasticidad), aproximar la distribución de los errores a la normalidad, y reducir la influencia de valores atípicos. Dominar cuándo y cómo aplicar transformaciones logarítmicas, potenciales, Box-Cox o Yeo-Johnson es fundamental para optimizar nuestros modelos <span class="citation" data-cites="box1964analysis yeo2000new">(<a href="references.html#ref-box1964analysis" role="doc-biblioref">Box y Cox 1964</a>; <a href="references.html#ref-yeo2000new" role="doc-biblioref">Yeo y Johnson 2000</a>)</span>.</p>
<p><strong>Tratamiento de variables categóricas</strong>: Las variables categóricas requieren estrategias específicas de codificación que preserven la información relevante sin introducir supuestos erróneos. La elección entre codificación ordinal, one-hot encoding, o técnicas más avanzadas puede impactar significativamente el rendimiento del modelo <span class="citation" data-cites="potdar2017comparative">(<a href="references.html#ref-potdar2017comparative" role="doc-biblioref">Potdar, Pardawala, y Pai 2017</a>)</span>.</p>
<p><strong>Interacciones entre variables</strong>: Las interacciones capturan cómo el efecto de una variable puede cambiar según el nivel de otra variable, revelando patrones que los efectos principales por sí solos no pueden detectar. Comprender los diferentes tipos de interacciones y sus aplicaciones es clave para modelar relaciones complejas en el mundo real <span class="citation" data-cites="jaccard2003interaction">(<a href="references.html#ref-jaccard2003interaction" role="doc-biblioref">Jaccard y Turrisi 2003</a>)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Objetivos de aprendizaje">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Objetivos de aprendizaje
</div>
</div>
<div class="callout-body-container callout-body">
<p>Al finalizar este capítulo, serás capaz de:</p>
<ol type="1">
<li><strong>Identificar cuándo aplicar transformaciones</strong> específicas según el problema: linearización, heterocedasticidad, normalidad, o atípicos.</li>
<li><strong>Aplicar transformaciones clásicas</strong> (logarítmica, potencial, inversa) y <strong>avanzadas</strong> (Box-Cox, Yeo-Johnson) de manera apropiada.</li>
<li><strong>Interpretar modelos transformados</strong>, comprendiendo cómo cambia el significado de los coeficientes después de la transformación.</li>
<li><strong>Codificar variables categóricas</strong> using ordinal encoding y one-hot encoding según la naturaleza de las categorías.</li>
<li><strong>Crear e interpretar términos de interacción</strong> entre variables continuas, categóricas, y mixtas.</li>
<li><strong>Aplicar ingeniería de características</strong> para crear nuevas variables predictivas mediante combinaciones, ratios y transformaciones.</li>
</ol>
</div>
</div>
<section id="transformaciones-de-variables-propósitos-y-aplicaciones" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="transformaciones-de-variables-propósitos-y-aplicaciones"><span class="header-section-number">4.1</span> Transformaciones de variables: propósitos y aplicaciones</h2>
<p>En el análisis de datos y la construcción de modelos estadísticos, los datos en su forma original no siempre están preparados para obtener el máximo rendimiento de nuestros modelos. Las <strong>transformaciones de variables</strong> son herramientas fundamentales que nos permiten modificar la estructura matemática de nuestros datos para abordar problemas específicos y mejorar significativamente el ajuste del modelo <span class="citation" data-cites="box1964analysis carroll1988transformation">(<a href="references.html#ref-box1964analysis" role="doc-biblioref">Box y Cox 1964</a>; <a href="references.html#ref-carroll1988transformation" role="doc-biblioref">Carroll y Ruppert 1988</a>)</span>.</p>
<p>La clave del éxito en las transformaciones está en diagnosticar correctamente el problema que enfrentamos y seleccionar la transformación apropiada. Cada transformación tiene propósitos específicos y consecuencias interpretativas que debemos comprender profundamente.</p>
<section id="diagnóstico-cuándo-transformar" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="diagnóstico-cuándo-transformar"><span class="header-section-number">4.1.1</span> Diagnóstico: ¿Cuándo transformar?</h3>
<p>El arte de las transformaciones no está en aplicarlas indiscriminadamente, sino en diagnosticar correctamente cuál es el problema que enfrentamos y seleccionar la transformación más apropiada para resolverlo. Un diagnóstico erróneo puede llevarnos a aplicar una transformación innecesaria o, peor aún, contraproducente que distorsione las relaciones reales en los datos.</p>
<p>La práctica común de “probar transformaciones hasta que mejore el ajuste” es metodológicamente peligrosa. Este enfoque de transformación por ensayo y error puede llevarnos a:</p>
<ul>
<li><strong>Sobreajuste</strong>: Optimizar el modelo para los datos específicos que tenemos, perdiendo capacidad de generalización.</li>
<li><strong>Pérdida de interpretabilidad</strong>: Aplicar transformaciones complejas sin comprender su significado teórico.</li>
<li><strong>Violación de supuestos</strong>: Resolver un problema creando otros nuevos (ej. transformar para normalidad pero introducir heterocedasticidad).</li>
<li><strong>Sesgo de selección</strong>: Elegir la transformación que da los “mejores” resultados sin justificación teórica.</li>
</ul>
<p>El proceso de diagnóstico debe ser <strong>sistemático y basado en evidencia visual y estadística</strong>. No basta con aplicar transformaciones porque “mejoran el R²”; debemos entender qué problema específico estamos resolviendo y cómo la transformación aborda ese problema desde una perspectiva teórica sólida.</p>
<p>Un enfoque metodológicamente sólido sigue estos principios:</p>
<ol type="1">
<li><p><strong>Diagnóstico previo</strong>: Identificar problemas específicos mediante análisis visual y tests estadísticos antes de decidir transformar.</p></li>
<li><p><strong>Justificación teórica</strong>: Cada transformación debe tener una base conceptual sólida. Por ejemplo, usar logaritmos para relaciones multiplicativas o raíz cuadrada para estabilizar varianza Poisson.</p></li>
<li><p><strong>Evaluación integral</strong>: No solo considerar el ajuste estadístico, sino también la interpretabilidad, robustez y generalización del modelo transformado.</p></li>
<li><p><strong>Validación posterior</strong>: Verificar que la transformación realmente resuelve el problema identificado sin crear nuevos problemas.</p></li>
<li><p><strong>Parsimonia</strong>: Preferir la transformación más simple que resuelva efectivamente el problema (principio de Occam aplicado a transformaciones).</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Recordatorio: Diagnóstico de problemas en regresión lineal">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recordatorio: Diagnóstico de problemas en regresión lineal
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Identificación de no linealidad:</strong> La no linealidad es uno de los problemas más comunes que enfrentamos en el modelado. <em>Diagnóstico visual:</em> gráficos de dispersión (Y vs.&nbsp;X), gráficos de componente + residuo (CPR plots), análisis de residuos vs.&nbsp;valores ajustados. <em>Diagnóstico estadístico:</em> Test de Ramsey RESET que evalúa si potencias de los valores ajustados mejoran significativamente el modelo.</p>
<p><strong>Detección de heterocedasticidad:</strong> La heterocedasticidad (varianza no constante) viola supuestos fundamentales de la regresión lineal y sesga las inferencias estadísticas. <em>Diagnóstico visual:</em> gráfico de residuos vs.&nbsp;valores ajustados (patrón “embudo”), gráfico Scale-Location, residuos vs.&nbsp;variables predictoras individuales. <em>Diagnóstico estadístico:</em> Test de Breusch-Pagan (el más utilizado) y Test de White (más general).</p>
<p><strong>Evaluación de normalidad de residuos:</strong> Aunque la normalidad no es crítica para estimación de coeficientes, sí es importante para inferencia estadística. <em>Diagnóstico visual:</em> histograma de residuos, QQ-plot de residuos. <em>Diagnóstico estadístico:</em> Test de Shapiro-Wilk (muestras pequeñas n&lt;50) y Test de Jarque-Bera.</p>
<p><strong>Detección de outliers y observaciones influyentes:</strong> Es fundamental distinguir entre outliers (valores extremos en Y) y observaciones influyentes (impacto en coeficientes). <em>Outliers:</em> boxplot de variable respuesta, residuos estudentizados, criterios |t<span class="math inline">\(_i\)</span>| &gt; 2. <em>Observaciones influyentes:</em> análisis de leverage, distancia de Cook, DFBETAS, DFFITS, con criterios específicos como h<span class="math inline">\(_i\)</span> &gt; 2p/n y D<span class="math inline">\(_i\)</span> &gt; 4/n.&nbsp;Las observaciones se clasifican en: normales, outliers no influyentes, influyentes sin ser outliers, y outliers influyentes.</p>
</div>
</div>
</div>
</section>
</section>
<section id="escalado-y-normalización-preparando-variables-para-el-análisis" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="escalado-y-normalización-preparando-variables-para-el-análisis"><span class="header-section-number">4.2</span> Escalado y normalización: preparando variables para el análisis</h2>
<p>Antes de aplicar transformaciones complejas, es fundamental asegurar que nuestras variables estén en escalas comparables. Aunque la regresión lineal ordinaria no requiere estrictamente el escalado de variables para obtener estimadores insesgados, el escalado se vuelve crítico para la interpretación y esencial en métodos avanzados de modelado.</p>
<p>En regresión múltiple, los coeficientes representan el cambio en Y por unidad de cambio en cada variable predictora. Cuando las variables tienen escalas muy diferentes, los coeficientes pierden comparabilidad directa. Una variable medida en miles de euros tendrá coeficientes numéricamente pequeños, mientras que una variable medida en porcentajes tendrá coeficientes grandes, independientemente de su importancia real en el modelo.</p>
<p>Esta disparidad de escalas genera problemas interpretativos fundamentales: comparar la “importancia” relativa de las variables se vuelve imposible basándose únicamente en la magnitud de los coeficientes. El escalado resuelve este problema permitiendo que los coeficientes estandarizados (beta coefficients) representen cambios en desviaciones estándar, facilitando comparaciones directas entre predictores y proporcionando una base sólida para evaluar la importancia relativa de cada variable.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Escalado en métodos de regularización">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Escalado en métodos de regularización
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>En regresión con regularización (Ridge, Lasso)</strong>, el problema se agrava dramáticamente. Las penalizaciones L1 y L2 afectan <strong>desproporcionadamente</strong> a variables con escalas grandes, llevando a regularización injusta donde variables con unidades grandes son penalizadas más severamente que variables con unidades pequeñas, independientemente de su relevancia predictiva. Esto puede resultar en selección de variables sesgada y estimadores subóptimos. Este tema se desarrollará en profundidad en el siguiente capítulo sobre métodos de regularización.</p>
</div>
</div>
</div>
<p>El escalado no es solo una cuestión técnica, sino una decisión metodológica que afecta directamente la interpretación y validez de nuestros resultados. La elección entre estandarización, normalización min-max, o escalado robusto debe basarse en las características de los datos y los objetivos del análisis, considerando siempre el impacto en la interpretabilidad de los resultados finales.</p>
<section id="estandarización-z-score" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="estandarización-z-score"><span class="header-section-number">4.2.1</span> Estandarización (Z-Score)</h3>
<p>La <strong>estandarización</strong> es la técnica de escalado más utilizada en estadística. Transforma cada variable para que tenga media cero y desviación estándar uno, preservando la forma de la distribución original.</p>
<p><span class="math display">\[X_{\text{estandarizado}} = \frac{X - \bar{X}}{\sigma_X}\]</span></p>
<p><strong>Propiedades de la estandarización:</strong></p>
<ul>
<li><strong>Preserva la forma de la distribución</strong>: Si X era normal, X estandarizado también lo será.</li>
<li><strong>Facilita la comparación</strong>: Los coeficientes en regresión múltiple se vuelven comparables.</li>
<li><strong>Robusta ante outliers moderados</strong>: La media y desviación estándar son menos sensibles que min-max a valores extremos.</li>
</ul>
<p><strong>Cuándo usar estandarización:</strong></p>
<ul>
<li>Variables con distribuciones aproximadamente normales.</li>
<li>Cuando necesitamos preservar la información sobre la variabilidad relativa.</li>
<li>En regresión múltiple para comparar la importancia relativa de las variables.</li>
<li>Como paso previo a técnicas multivariantes (PCA, análisis discriminante).</li>
</ul>
</section>
<section id="normalización-min-max" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="normalización-min-max"><span class="header-section-number">4.2.2</span> Normalización Min-Max</h3>
<p>La <strong>normalización Min-Max</strong> escala las variables a un rango específico, típicamente [0,1], preservando las relaciones relativas entre los valores.</p>
<p><span class="math display">\[X_{\text{normalizado}} = \frac{X - X_{\text{min}}}{X_{\text{max}} - X_{\text{min}}}\]</span></p>
<p><strong>Propiedades de la normalización Min-Max:</strong></p>
<ul>
<li><strong>Rango acotado</strong>: Todas las variables transformadas tienen el mismo rango [0,1].</li>
<li><strong>Preserva relaciones</strong>: Las distancias relativas entre observaciones se mantienen.</li>
<li><strong>Interpretación intuitiva</strong>: 0 representa el mínimo observado, 1 el máximo observado.</li>
</ul>
<p><strong>Cuándo usar normalización Min-Max:</strong></p>
<ul>
<li>Cuando necesitamos un rango específico (ej. entradas de redes neuronales).</li>
<li>Variables con distribuciones uniformes o sin outliers extremos.</li>
<li>Cuando la interpretación en términos de mínimo-máximo es relevante.</li>
<li>En algoritmos que requieren entradas en [0,1] (algunos métodos de ensemble).</li>
</ul>
<p><strong>Limitaciones:</strong></p>
<ul>
<li><strong>Muy sensible a outliers</strong>: Un solo valor extremo puede comprimir toda la distribución.</li>
<li><strong>No preserva la normalidad</strong>: Una distribución normal se vuelve uniforme tras Min-Max.</li>
</ul>
</section>
<section id="escalado-robusto" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="escalado-robusto"><span class="header-section-number">4.2.3</span> Escalado robusto</h3>
<p>Para datos con outliers significativos, el escalado robusto utiliza la mediana y el rango intercuartílico (IQR) en lugar de la media y desviación estándar:</p>
<p><span class="math display">\[X_{\text{robusto}} = \frac{X - \text{mediana}(X)}{\text{IQR}(X)}\]</span></p>
<p>Este método es menos sensible a valores extremos y preserva mejor la estructura de los datos en presencia de outliers.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo comparativo: Escalado de variables">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo comparativo: Escalado de variables
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar datos de ejemplo con diferentes escalas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable de ejemplo: Ingresos en miles de euros</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>ingresos <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar diferentes transformaciones</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>ingresos_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(ingresos)[,<span class="dv">1</span>]  <span class="co"># Estandarización</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>ingresos_norm <span class="ot">&lt;-</span> (ingresos <span class="sc">-</span> <span class="fu">min</span>(ingresos)) <span class="sc">/</span> (<span class="fu">max</span>(ingresos) <span class="sc">-</span> <span class="fu">min</span>(ingresos))  <span class="co"># Min-Max</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>ingresos_robust <span class="ot">&lt;-</span> (ingresos <span class="sc">-</span> <span class="fu">median</span>(ingresos)) <span class="sc">/</span> <span class="fu">IQR</span>(ingresos)  <span class="co"># Robusto</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla comparativa</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>tabla_escalado <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  Método <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Original"</span>, <span class="st">"Estandarización"</span>, <span class="st">"Min-Max"</span>, <span class="st">"Escalado Robusto"</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Media =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ingresos), <span class="fu">mean</span>(ingresos_std), <span class="fu">mean</span>(ingresos_norm), <span class="fu">median</span>(ingresos_robust)), <span class="dv">3</span>),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  Desviación <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">sd</span>(ingresos), <span class="fu">sd</span>(ingresos_std), <span class="fu">sd</span>(ingresos_norm), <span class="fu">mad</span>(ingresos_robust)), <span class="dv">3</span>),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  Mínimo <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">min</span>(ingresos), <span class="fu">min</span>(ingresos_std), <span class="fu">min</span>(ingresos_norm), <span class="fu">min</span>(ingresos_robust)), <span class="dv">3</span>),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  Máximo <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">max</span>(ingresos), <span class="fu">max</span>(ingresos_std), <span class="fu">max</span>(ingresos_norm), <span class="fu">max</span>(ingresos_robust)), <span class="dv">3</span>),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rango =</span> <span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(ingresos) <span class="sc">-</span> <span class="fu">min</span>(ingresos),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(ingresos_std) <span class="sc">-</span> <span class="fu">min</span>(ingresos_std),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(ingresos_norm) <span class="sc">-</span> <span class="fu">min</span>(ingresos_norm),</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(ingresos_robust) <span class="sc">-</span> <span class="fu">min</span>(ingresos_robust)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  ), <span class="dv">3</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla_escalado, <span class="at">caption =</span> <span class="st">"Comparación de métodos de escalado en variable Ingresos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparación de métodos de escalado en variable Ingresos</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Media</th>
<th style="text-align: right;">Desviación</th>
<th style="text-align: right;">Mínimo</th>
<th style="text-align: right;">Máximo</th>
<th style="text-align: right;">Rango</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Original</td>
<td style="text-align: right;">51.356</td>
<td style="text-align: right;">13.692</td>
<td style="text-align: right;">15.362</td>
<td style="text-align: right;">82.810</td>
<td style="text-align: right;">67.448</td>
</tr>
<tr class="even">
<td style="text-align: left;">Estandarización</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-2.629</td>
<td style="text-align: right;">2.297</td>
<td style="text-align: right;">4.926</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Min-Max</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Escalado Robusto</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">-2.000</td>
<td style="text-align: right;">1.793</td>
<td style="text-align: right;">3.792</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Interpretación de los resultados:</strong></p>
<ul>
<li><strong>Original</strong>: Ingresos en miles de euros con gran variabilidad (SD ≈ 15)</li>
<li><strong>Estandarización</strong>: Media = 0, SD = 1, preservando la forma de la distribución</li>
<li><strong>Min-Max</strong>: Valores acotados entre [0,1], comprimiendo toda la variabilidad en este rango</li>
<li><strong>Escalado Robusto</strong>: Centrado en la mediana, menos sensible a valores extremos</li>
</ul>
<p>Cada método transforma los datos de manera diferente según el objetivo: comparabilidad (estandarización), rango específico (min-max), o robustez ante outliers (robusto).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo con outliers: Escalado robusto">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo con outliers: Escalado robusto
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos con outliers</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>datos_normales <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">95</span>, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">45</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>datos_outliers <span class="ot">&lt;-</span> <span class="fu">c</span>(datos_normales, outliers)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar diferentes métodos de escalado</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>std_clasica <span class="ot">&lt;-</span> <span class="fu">scale</span>(datos_outliers)[,<span class="dv">1</span>]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>norm_minmax <span class="ot">&lt;-</span> (datos_outliers <span class="sc">-</span> <span class="fu">min</span>(datos_outliers)) <span class="sc">/</span> (<span class="fu">max</span>(datos_outliers) <span class="sc">-</span> <span class="fu">min</span>(datos_outliers))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>escalado_robusto <span class="ot">&lt;-</span> (datos_outliers <span class="sc">-</span> <span class="fu">median</span>(datos_outliers)) <span class="sc">/</span> <span class="fu">IQR</span>(datos_outliers)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla comparativa</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>tabla_outliers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  Método <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Original"</span>, <span class="st">"Estandarización"</span>, <span class="st">"Min-Max"</span>, <span class="st">"Escalado Robusto"</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Media_Mediana =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(datos_outliers), <span class="fu">mean</span>(std_clasica), <span class="fu">mean</span>(norm_minmax), <span class="fu">median</span>(escalado_robusto)), <span class="dv">3</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  Desviación <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">sd</span>(datos_outliers), <span class="fu">sd</span>(std_clasica), <span class="fu">sd</span>(norm_minmax), <span class="fu">mad</span>(escalado_robusto)), <span class="dv">3</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  Mínimo <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">min</span>(datos_outliers), <span class="fu">min</span>(std_clasica), <span class="fu">min</span>(norm_minmax), <span class="fu">min</span>(escalado_robusto)), <span class="dv">3</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  Máximo <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">max</span>(datos_outliers), <span class="fu">max</span>(std_clasica), <span class="fu">max</span>(norm_minmax), <span class="fu">max</span>(escalado_robusto)), <span class="dv">3</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q25_Q75 =</span> <span class="fu">c</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(datos_outliers, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)), <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">" - "</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(std_clasica, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)), <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">" - "</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(norm_minmax, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)), <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">" - "</span>),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(escalado_robusto, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)), <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">" - "</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla_outliers, <span class="at">caption =</span> <span class="st">"Comparación de métodos de escalado con outliers presentes"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparación de métodos de escalado con outliers presentes</caption>
<colgroup>
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Media_Mediana</th>
<th style="text-align: right;">Desviación</th>
<th style="text-align: right;">Mínimo</th>
<th style="text-align: right;">Máximo</th>
<th style="text-align: left;">Q25_Q75</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Original</td>
<td style="text-align: right;">11.447</td>
<td style="text-align: right;">5.996</td>
<td style="text-align: right;">5.491</td>
<td style="text-align: right;">45.000</td>
<td style="text-align: left;">8.93 - 11.81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Estandarización</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.993</td>
<td style="text-align: right;">5.595</td>
<td style="text-align: left;">-0.42 - 0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Min-Max</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">0.09 - 0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Escalado Robusto</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">-1.654</td>
<td style="text-align: right;">12.108</td>
<td style="text-align: left;">-0.45 - 0.55</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Análisis del impacto de outliers:</strong></p>
<ul>
<li><strong>Datos originales</strong>: Los outliers extienden el rango de ~6-14 a 6-45, distorsionando las medidas centrales</li>
<li><strong>Estandarización</strong>: Afectada por outliers en media y desviación estándar, resultando en distribución asimétrica</li>
<li><strong>Min-Max</strong>: Extremadamente sensible. Los datos normales quedan comprimidos en un rango muy pequeño (~0.0-0.2)</li>
<li><strong>Escalado robusto</strong>: Mantiene mejor las proporciones de la distribución central, minimizando la influencia de valores extremos</li>
</ul>
<p><strong>Conclusión</strong>: El escalado robusto es superior cuando hay outliers, preservando la estructura de la mayoría de observaciones.</p>
</div>
</div>
</div>
</section>
</section>
<section id="catálogo-de-transformaciones-según-el-propósito" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="catálogo-de-transformaciones-según-el-propósito"><span class="header-section-number">4.3</span> Catálogo de transformaciones según el propósito</h2>
<p>Una vez realizado el diagnóstico, debemos seleccionar la transformación más apropiada. Cada transformación tiene propósitos específicos y efectos secundarios que debemos considerar. La clave está en entender no solo qué transformación aplicar, sino por qué esa transformación específica resuelve nuestro problema.</p>
<section id="transformaciones-para-linearizar-relaciones" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="transformaciones-para-linearizar-relaciones"><span class="header-section-number">4.3.1</span> Transformaciones para linearizar relaciones</h3>
<p>Muchas relaciones en el mundo real no son lineales, pero pueden linearizarse mediante transformaciones apropiadas. La linearización no solo mejora el ajuste del modelo, sino que también facilita la interpretación y cumple con los supuestos de la regresión lineal.</p>
<section id="transformación-logarítmica" class="level4" data-number="4.3.1.1">
<h4 data-number="4.3.1.1" class="anchored" data-anchor-id="transformación-logarítmica"><span class="header-section-number">4.3.1.1</span> Transformación logarítmica</h4>
<p>La transformación logarítmica es probablemente la más utilizada en estadística aplicada debido a su versatilidad y propiedades interpretativas únicas.</p>
<p><strong>Cuándo utilizarla:</strong></p>
<ul>
<li>Relaciones exponenciales: Cuando Y crece exponencialmente respecto a X, <span class="math inline">\(Y = ae^{bX}\)</span> se lineariza como <span class="math inline">\(\log(Y) = \log(a) + bX\)</span></li>
<li>Relaciones multiplicativas: En modelos donde los efectos se combinan multiplicativamente</li>
<li>Procesos de crecimiento proporcional: Donde la tasa de cambio es proporcional al nivel actual</li>
<li>Variables con crecimiento acelerado: Ingresos, precios, donde cada unidad adicional tiene impacto decreciente</li>
</ul>
<p><strong>Patrones de identificación:</strong></p>
<ul>
<li>Curva cóncava que se aplana hacia la derecha (rendimientos decrecientes)</li>
<li>Relación donde duplicar X no duplica Y, sino que el efecto se atenúa</li>
<li>Heterocedasticidad donde la varianza aumenta con el nivel de Y</li>
</ul>
<p><strong>Aplicaciones matemáticas:</strong></p>
<ul>
<li><span class="math inline">\(Y' = \log(Y)\)</span>: Lineariza relaciones exponenciales en Y</li>
<li><span class="math inline">\(X' = \log(X)\)</span>: Lineariza relaciones de potencia en X<br>
</li>
<li><span class="math inline">\(\log(Y) = a + b\log(X)\)</span>: Modelo log-log que produce elasticidades constantes</li>
</ul>
<p><strong>Interpretación especial:</strong> En modelos log-lineales y log-log, los coeficientes tienen interpretaciones económicas directas. En el modelo log-lineal <span class="math inline">\(\log(Y) = a + bX\)</span>, el coeficiente b representa el cambio porcentual en Y por unidad de cambio en X. En el modelo log-log <span class="math inline">\(\log(Y) = a + b\log(X)\)</span>, b es la elasticidad.</p>
<p><strong>Casos típicos:</strong> Economía (relaciones ingreso-consumo, funciones de producción), biología (crecimiento poblacional, relaciones alométricas), finanzas (rendimientos de inversión).</p>
</section>
<section id="transformación-de-potencia" class="level4" data-number="4.3.1.2">
<h4 data-number="4.3.1.2" class="anchored" data-anchor-id="transformación-de-potencia"><span class="header-section-number">4.3.1.2</span> Transformación de potencia</h4>
<p>Las transformaciones de potencia son fundamentales cuando trabajamos con leyes físicas o relaciones alométricas donde esperamos relaciones del tipo <span class="math inline">\(Y = aX^b\)</span>.</p>
<p><strong>Identificación y aplicación:</strong></p>
<ul>
<li>Relaciones curvilíneas que en escala log-log se vuelven lineales</li>
<li>Método de linearización: tomar logaritmo de ambas variables <span class="math inline">\(\log(Y) = \log(a) + b\log(X)\)</span></li>
<li>El exponente b representa la elasticidad o exponente de escalamiento</li>
</ul>
<p><strong>Ejemplos clásicos:</strong> Ley de Stevens en psicofísica, relaciones masa-metabolismo (Ley de Kleiber), economía urbana donde PIB de ciudades escala con población elevada a una potencia.</p>
</section>
</section>
<section id="transformaciones-para-estabilizar-la-varianza" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="transformaciones-para-estabilizar-la-varianza"><span class="header-section-number">4.3.2</span> Transformaciones para estabilizar la varianza</h3>
<p>La heterocedasticidad no solo viola supuestos del modelo, sino que también indica que diferentes observaciones tienen diferentes niveles de información. Las transformaciones de varianza estabilizan esta heterogeneidad.</p>
<section id="transformación-de-raíz-cuadrada" class="level4" data-number="4.3.2.1">
<h4 data-number="4.3.2.1" class="anchored" data-anchor-id="transformación-de-raíz-cuadrada"><span class="header-section-number">4.3.2.1</span> Transformación de raíz cuadrada</h4>
<p>La transformación <span class="math inline">\(Y' = \sqrt{Y}\)</span> es especialmente útil para datos de conteo donde la varianza es proporcional a la media, característica típica de la distribución de Poisson.</p>
<p><strong>Fundamento teórico:</strong> En una distribución de Poisson con parámetro <span class="math inline">\(\lambda\)</span>, tanto la media como la varianza son iguales a <span class="math inline">\(\lambda\)</span>. La transformación de raíz cuadrada estabiliza la varianza porque <span class="math inline">\(\text{Var}(\sqrt{Y}) \approx \frac{1}{4}\)</span> (constante).</p>
<p><strong>Cuándo aplicarla:</strong></p>
<ul>
<li>Conteos de eventos: número de defectos, llamadas telefónicas, accidentes, ventas por período</li>
<li>Datos de frecuencia: número de visitas, clicks, transacciones</li>
<li>Variables discretas con varianza creciente proporcional al nivel</li>
</ul>
<p><strong>Patrón de diagnóstico:</strong> Gráfico de residuos con forma de embudo donde la dispersión aumenta linealmente con la media, y gráfico de varianza vs.&nbsp;media de grupos muestra relación lineal.</p>
<p><strong>Limitaciones:</strong> Solo apropiada para valores no negativos, interpretación complicada (unidades en raíz cuadrada), y para conteos con muchos ceros puede requerir <span class="math inline">\(\sqrt{Y + c}\)</span>.</p>
</section>
<section id="transformación-logarítmica-para-heterocedasticidad-multiplicativa" class="level4" data-number="4.3.2.2">
<h4 data-number="4.3.2.2" class="anchored" data-anchor-id="transformación-logarítmica-para-heterocedasticidad-multiplicativa"><span class="header-section-number">4.3.2.2</span> Transformación logarítmica para heterocedasticidad multiplicativa</h4>
<p>Cuando la varianza es proporcional al cuadrado de la media (heterocedasticidad multiplicativa), la transformación logarítmica es la solución natural.</p>
<p><strong>Características típicas:</strong></p>
<ul>
<li>Variables monetarias: ingresos, precios, costos donde el error relativo es constante</li>
<li>Porcentajes de crecimiento: donde el error de medición es proporcional al nivel</li>
<li>Procesos multiplicativos: donde los errores se acumulan multiplicativamente</li>
</ul>
<p><strong>Efectos múltiples:</strong> La transformación logarítmica frecuentemente resuelve múltiples problemas simultáneamente: lineariza relaciones exponenciales, estabiliza varianza multiplicativa, reduce el impacto de outliers extremos, y aproxima distribuciones asimétricas a la normalidad.</p>
</section>
</section>
<section id="transformaciones-para-normalizar-residuos-y-controlar-outliers" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="transformaciones-para-normalizar-residuos-y-controlar-outliers"><span class="header-section-number">4.3.3</span> Transformaciones para normalizar residuos y controlar outliers</h3>
<p>Algunas transformaciones son especialmente efectivas para aproximar distribuciones a la normalidad y reducir la influencia de valores extremos.</p>
<section id="transformación-inversa" class="level4" data-number="4.3.3.1">
<h4 data-number="4.3.3.1" class="anchored" data-anchor-id="transformación-inversa"><span class="header-section-number">4.3.3.1</span> Transformación inversa</h4>
<p>La transformación inversa <span class="math inline">\(Y' = \frac{1}{Y}\)</span> o <span class="math inline">\(X' = \frac{1}{X}\)</span> es útil para relaciones hiperbólicas y distribuciones con colas pesadas hacia la derecha.</p>
<p><strong>Identificación matemática:</strong></p>
<ul>
<li>Relación hiperbólica: <span class="math inline">\(Y = \frac{a}{X} + b\)</span> se lineariza como <span class="math inline">\(Y = a \cdot \frac{1}{X} + b\)</span></li>
<li>Asíntota horizontal: la relación se aproxima a un valor límite cuando X aumenta</li>
</ul>
<p><strong>Aplicaciones específicas:</strong> Tiempo hasta el evento (con asíntota natural), tasas de decaimiento, relaciones dosis-respuesta en farmacología, curvas de demanda con elasticidad precio variable.</p>
<p><strong>Efecto en outliers:</strong> La transformación inversa invierte la escala, comprimiendo fuertemente los valores grandes y expandiendo los pequeños. Útil para reducir influencia de outliers extremos, pero debe usarse con precaución ya que amplifica errores en valores pequeños.</p>
<p><strong>Consideraciones prácticas:</strong> Solo aplicable a valores estrictamente positivos (o negativos), los coeficientes representan el impacto en la escala inversa, y requiere tratamiento especial para valores cercanos a cero.</p>
</section>
</section>
</section>
<section id="transformación-de-box-cox" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="transformación-de-box-cox"><span class="header-section-number">4.4</span> Transformación de Box-Cox</h2>
<p>La transformación de Box-Cox es un método que optimiza automáticamente el parámetro de transformación para maximizar la normalidad y homocedasticidad de los residuos <span class="citation" data-cites="box1964analysis">(<a href="references.html#ref-box1964analysis" role="doc-biblioref">Box y Cox 1964</a>)</span>. En lugar de elegir manualmente entre transformación logarítmica, raíz cuadrada o inversa, Box-Cox encuentra el valor <span class="math inline">\(\lambda\)</span> (lambda) que mejor normaliza los datos.</p>
<section id="definición-matemática" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="definición-matemática"><span class="header-section-number">4.4.1</span> Definición matemática</h3>
<p><span class="math display">\[Y(\lambda) = \begin{cases}
\frac{Y^\lambda - 1}{\lambda}, &amp; \lambda \neq 0 \\
\log(Y), &amp; \lambda = 0
\end{cases}\]</span></p>
<p>Los valores especiales de <span class="math inline">\(\lambda\)</span> corresponden a transformaciones clásicas:</p>
<ul>
<li><strong><span class="math inline">\(\lambda\)</span> = 1</strong>: Sin transformación (identidad)</li>
<li><strong><span class="math inline">\(\lambda\)</span> = 0.5</strong>: Transformación de raíz cuadrada<br>
</li>
<li><strong><span class="math inline">\(\lambda\)</span> = 0</strong>: Transformación logarítmica</li>
<li><strong><span class="math inline">\(\lambda\)</span> = -1</strong>: Transformación inversa</li>
</ul>
</section>
<section id="propósito-y-ventajas" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="propósito-y-ventajas"><span class="header-section-number">4.4.2</span> Propósito y ventajas</h3>
<p><strong>Para qué sirve Box-Cox:</strong></p>
<ul>
<li>Encuentra automáticamente la transformación óptima sin prueba y error</li>
<li>Maximiza la verosimilitud del modelo, mejorando simultáneamente normalidad y homocedasticidad</li>
<li>Proporciona un método objetivo para seleccionar la transformación apropiada</li>
<li>Incluye intervalos de confianza para <span class="math inline">\(\lambda\)</span>, permitiendo evaluar la incertidumbre de la estimación</li>
</ul>
<p><strong>Procedimiento de aplicación:</strong></p>
<ol type="1">
<li>Se ajusta el modelo original y se calculan los residuos</li>
<li>Se evalúa la función de verosimilitud para diferentes valores de <span class="math inline">\(\lambda\)</span></li>
<li>Se selecciona el <span class="math inline">\(\lambda\)</span> que maximiza la verosimilitud</li>
<li>Se aplica la transformación con el <span class="math inline">\(\lambda\)</span> óptimo encontrado</li>
</ol>
</section>
<section id="limitaciones-importantes" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="limitaciones-importantes"><span class="header-section-number">4.4.3</span> Limitaciones importantes</h3>
<p><strong>Restricción de dominio:</strong> Box-Cox requiere que todos los valores de Y sean estrictamente positivos. Esta es su limitación más importante, ya que muchos conjuntos de datos reales incluyen ceros o valores negativos.</p>
<p><strong>Aplicación tradicional:</strong> Se aplica principalmente a la variable dependiente Y, no a las variables predictoras. Aunque técnicamente es posible aplicarla a X, la interpretación se complica considerablemente.</p>
<p><strong>Interpretación compleja:</strong> Cuando <span class="math inline">\(\lambda\)</span> no corresponde a valores “simples” (como 0, 0.5, o 1), la interpretación de los coeficientes se vuelve difícil. Por ejemplo, si <span class="math inline">\(\lambda\)</span> = 0.37, ¿cómo interpretar un coeficiente en la escala transformada?</p>
<p><strong>Dependencia del modelo:</strong> El <span class="math inline">\(\lambda\)</span> óptimo depende del modelo específico (predictores incluidos), por lo que cambiar el modelo puede requerir recalcular la transformación.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Extensión: Transformación de Yeo-Johnson">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Extensión: Transformación de Yeo-Johnson
</div>
</div>
<div class="callout-body-container callout-body">
<p>La transformación de Yeo-Johnson <span class="citation" data-cites="yeo2000new">(<a href="references.html#ref-yeo2000new" role="doc-biblioref">Yeo y Johnson 2000</a>)</span> fue desarrollada específicamente para superar la limitación principal de Box-Cox: la restricción a valores positivos.</p>
<p><strong>Ventajas de Yeo-Johnson sobre Box-Cox:</strong></p>
<ul>
<li><strong>Sin restricción de dominio</strong>: Acepta cualquier valor real, incluyendo negativos y cero</li>
<li><strong>Preserva el signo</strong>: Los valores negativos permanecen negativos tras la transformación</li>
<li><strong>Continuidad</strong>: La transformación es continua en Y = 0, evitando discontinuidades</li>
<li><strong>Casos especiales familiares</strong>: Incluye como casos especiales todas las transformaciones comunes</li>
</ul>
<p><strong>Cuándo usar cada una:</strong></p>
<ul>
<li><strong>Box-Cox</strong>: Para datos estrictamente positivos, especialmente cuando se busca comparabilidad con literatura existente</li>
<li><strong>Yeo-Johnson</strong>: Cuando los datos incluyen valores negativos o cero, o cuando se necesita mayor flexibilidad</li>
</ul>
<p>La elección entre ambas depende fundamentalmente de las características de sus datos y los objetivos del análisis.</p>
</div>
</div>
</section>
</section>
<section id="tratamiento-de-variables-categóricas" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="tratamiento-de-variables-categóricas"><span class="header-section-number">4.5</span> Tratamiento de variables categóricas</h2>
<p>Las <strong>variables categóricas</strong> son fundamentales en el modelado estadístico, pero requieren una preparación especial antes de ser utilizadas en algoritmos que esperan entradas numéricas <span class="citation" data-cites="potdar2017comparative">(<a href="references.html#ref-potdar2017comparative" role="doc-biblioref">Potdar, Pardawala, y Pai 2017</a>)</span>. La elección del método de codificación puede impactar significativamente tanto la interpretabilidad como el rendimiento del modelo.</p>
<section id="principios-de-codificación-categórica" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="principios-de-codificación-categórica"><span class="header-section-number">4.5.1</span> Principios de codificación categórica</h3>
<p>¿Por qué codificar? La mayoría de algoritmos de machine learning y modelos estadísticos requieren entradas numéricas. Las variables categóricas deben transformarse preservando su información semántica sin introducir supuestos erróneos sobre relaciones entre categorías.</p>
<p><strong>Criterios de selección del método:</strong></p>
<ul>
<li><strong>Naturaleza de la variable</strong>: ¿Existe orden inherente entre categorías?</li>
<li><strong>Número de categorías</strong>: Variables con muchas categorías requieren consideraciones especiales</li>
<li><strong>Interpretabilidad</strong>: ¿Qué método facilita la interpretación de resultados?</li>
<li><strong>Eficiencia computacional</strong>: Balance entre precisión y complejidad</li>
</ul>
</section>
<section id="codificación-one-hot-variables-nominales" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="codificación-one-hot-variables-nominales"><span class="header-section-number">4.5.2</span> Codificación One-Hot (variables nominales)</h3>
<p>El <strong>One-Hot Encoding</strong> transforma variables categóricas nominales en un conjunto de variables binarias (0/1), donde cada nueva variable representa la presencia o ausencia de una categoría específica. Esta técnica es fundamental cuando trabajamos con variables categóricas que no tienen orden inherente, como color, género, región geográfica, o tipo de producto.</p>
<p>La transformación convierte una variable categórica con <em>k</em> categorías en <em>k</em> nuevas columnas binarias (o <em>k-1</em> para evitar colinealidad). Cada fila tendrá exactamente un “1” en la columna correspondiente a su categoría y “0” en todas las demás.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Dummy Variable Trap">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dummy Variable Trap
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cuando se crean todas las columnas (k para k categorías), una puede expresarse como combinación lineal de las demás, causando colinealidad perfecta en modelos lineales.</p>
<p><strong>Solución:</strong> Eliminar una categoría de referencia (usar k-1 columnas).</p>
</div>
</div>
<p>¿Por qué es necesario? La mayoría de algoritmos de machine learning requieren entradas numéricas y no pueden procesar directamente texto categórico. Más importante aún, el One-Hot Encoding no impone orden artificial entre categorías, tratando cada una como completamente independiente.</p>
<p><strong>Ejemplo práctico:</strong> Consideremos una variable “Color” con valores [Rojo, Verde, Azul]. La codificación One-Hot creará tres columnas:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 23%">
<col style="width: 25%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><strong>ID</strong></th>
<th><strong>Color</strong></th>
<th><strong>Color_Rojo</strong></th>
<th><strong>Color_Verde</strong></th>
<th><strong>Color_Azul</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Rojo</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>Verde</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Azul</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>4</td>
<td>Rojo</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Cada observación queda representada por un vector binario que identifica unívocamente su categoría sin asumir relaciones ordinales entre colores.</p>
<p><strong>Interpretación en regresión:</strong> En un modelo de regresión lineal, cada variable binaria creada tendrá su propio coeficiente que representa la diferencia en la variable respuesta entre esa categoría específica y la categoría de referencia (la omitida). Por ejemplo, si omitimos “Azul”, el coeficiente de “Color_Rojo” indicará cuánto mayor (o menor) es el valor esperado de Y cuando el color es Rojo comparado con cuando es Azul.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Implementación práctica">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Implementación práctica
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear datos de ejemplo</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(caret))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Color =</span> <span class="fu">c</span>(<span class="st">"Rojo"</span>, <span class="st">"Verde"</span>, <span class="st">"Azul"</span>, <span class="st">"Rojo"</span>, <span class="st">"Verde"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Método 1: usando model.matrix (incluye todas las categorías)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>one_hot_completo <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> Color <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> datos)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>one_hot_completo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ColorAzul ColorRojo ColorVerde
1         0         1          0
2         0         0          1
3         1         0          0
4         0         1          0
5         0         0          1
attr(,"assign")
[1] 1 1 1
attr(,"contrasts")
attr(,"contrasts")$Color
[1] "contr.treatment"</code></pre>
</div>
</div>
<p>Método 2: eliminando categoría de referencia (evita colinealidad)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>one_hot_referencia <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> Color, <span class="at">data =</span> datos)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>one_hot_referencia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ColorRojo ColorVerde
1         1          0
2         0          1
3         0          0
4         1          0
5         0          1</code></pre>
</div>
</div>
<p>Método 3: usando <code>caret::dummyVars</code> con <code>fullRank</code> para evitar colinealidad</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dummy_vars <span class="ot">&lt;-</span> <span class="fu">dummyVars</span>(<span class="sc">~</span> Color, <span class="at">data =</span> datos, <span class="at">fullRank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>one_hot_caret <span class="ot">&lt;-</span> <span class="fu">predict</span>(dummy_vars, <span class="at">newdata =</span> datos)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>one_hot_caret</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ColorRojo ColorVerde
1         1          0
2         0          1
3         0          0
4         1          0
5         0          1</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Ventajas y desventajas">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ventajas y desventajas
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Ventajas del One-Hot Encoding:</strong></p>
<ul>
<li><strong>No asume orden</strong>: Trata cada categoría como independiente</li>
<li><strong>Interpretabilidad</strong>: Cada coeficiente representa el efecto específico de esa categoría</li>
<li><strong>Compatibilidad</strong>: Funciona con todos los algoritmos numéricos</li>
</ul>
<p><strong>Desventajas:</strong></p>
<ul>
<li><strong>Dimensionalidad</strong>: Crea k columnas para k categorías (o k-1 con categoría de referencia)</li>
<li><strong>Dispersión</strong>: Matrices resultantes son muy dispersas (muchos ceros)</li>
<li><strong>Colinealidad</strong>: Riesgo de “dummy variable trap” sin categoría de referencia</li>
</ul>
</div>
</div>
</section>
<section id="codificación-ordinal-variables-ordinales" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="codificación-ordinal-variables-ordinales"><span class="header-section-number">4.5.3</span> Codificación Ordinal (variables ordinales)</h3>
<p>La <strong>codificación ordinal</strong> transforma variables categóricas ordinales en números enteros que preservan el orden jerárquico natural de las categorías. Esta técnica es fundamental cuando trabajamos with variables categóricas que tienen un orden inherente y significativo, como nivel educativo, satisfacción del cliente, grado de severidad, o calificaciones de crédito.</p>
<p>La transformación asigna números enteros consecutivos que reflejan la jerarquía natural de las categorías, preservando tanto la información categórica como el orden relativo entre ellas.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Cuándo usar codificación ordinal">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cuándo usar codificación ordinal
</div>
</div>
<div class="callout-body-container callout-body">
<p>La codificación ordinal es apropiada cuando las categorías tienen un orden natural claro y este orden es relevante para el fenómeno que estamos modelando. El modelo puede aprovechar esta información ordinal para capturar tendencias o patrones relacionados con la jerarquía de las categorías.</p>
</div>
</div>
<p>¿Por qué preservar el orden? Los algoritmos de machine learning pueden aprovechar la información ordinal para identificar tendencias y patrones que se perderían con one-hot encoding. Cuando el orden es significativo, la codificación ordinal es más eficiente y puede mejorar el rendimiento del modelo.</p>
<p><strong>Ejemplo práctico:</strong> Consideremos una variable “Satisfacción” con valores ordenados [Muy Insatisfecho, Insatisfecho, Neutral, Satisfecho, Muy Satisfecho]. La codificación ordinal asignará:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>ID</strong></th>
<th><strong>Satisfacción</strong></th>
<th><strong>Satisfacción_Codificada</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Muy Insatisfecho</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>Insatisfecho</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Neutral</td>
<td>3</td>
</tr>
<tr class="even">
<td>4</td>
<td>Satisfecho</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Muy Satisfecho</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>Cada observación queda representada por un número entero que preserva el orden jerárquico de las categorías originales.</p>
<p><strong>Interpretación en regresión:</strong> En un modelo de regresión lineal, el coeficiente de la variable ordinal codificada representa el cambio promedio en la variable respuesta por cada incremento de una unidad en el nivel ordinal. Por ejemplo, si el coeficiente es 2.5, esto significa que pasar del nivel 1 al 2, o del 3 al 4, se asocia en promedio con un aumento de 2.5 unidades en la variable respuesta, asumiendo intervalos uniformes entre niveles.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Implementación práctica">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Implementación práctica
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear datos de ejemplo</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Satisfaccion =</span> <span class="fu">c</span>(<span class="st">"Muy Insatisfecho"</span>, <span class="st">"Insatisfecho"</span>, <span class="st">"Neutral"</span>, <span class="st">"Satisfecho"</span>, <span class="st">"Muy Satisfecho"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir en factor ordenado</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Satisfaccion_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(datos<span class="sc">$</span>Satisfaccion, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Muy Insatisfecho"</span>, <span class="st">"Insatisfecho"</span>, <span class="st">"Neutral"</span>, <span class="st">"Satisfecho"</span>, <span class="st">"Muy Satisfecho"</span>), </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Codificación ordinal manual</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Satisfaccion_codificada <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(datos<span class="sc">$</span>Satisfaccion_factor)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar la codificación</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>datos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID     Satisfaccion Satisfaccion_factor Satisfaccion_codificada
1  1 Muy Insatisfecho    Muy Insatisfecho                       1
2  2     Insatisfecho        Insatisfecho                       2
3  3          Neutral             Neutral                       3
4  4       Satisfecho          Satisfecho                       4
5  5   Muy Satisfecho      Muy Satisfecho                       5</code></pre>
</div>
</div>
<p>Ejemplo de uso en regresión:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simular variable respuesta correlacionada con el orden</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Puntuacion <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo de regresión</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(Puntuacion <span class="sc">~</span> Satisfaccion_codificada, <span class="at">data =</span> datos)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Puntuacion ~ Satisfaccion_codificada, data = datos)

Residuals:
      1       2       3       4       5 
-0.2090 -0.1279  0.6826 -0.1455 -0.2002 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              -0.1552     0.4640  -0.335 0.759968    
Satisfaccion_codificada   2.0840     0.1399  14.896 0.000657 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4424 on 3 degrees of freedom
Multiple R-squared:  0.9867,    Adjusted R-squared:  0.9822 
F-statistic: 221.9 on 1 and 3 DF,  p-value: 0.0006565</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Ventajas y desventajas">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ventajas y desventajas
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Ventajas de la codificación ordinal:</strong></p>
<ul>
<li><strong>Preserva la jerarquía</strong>: Mantiene el orden natural entre categorías</li>
<li><strong>Eficiencia dimensional</strong>: Una sola columna independiente del número de categorías</li>
<li><strong>Interpretabilidad</strong>: Coeficientes representan cambios por unidad de nivel ordinal</li>
<li><strong>Eficiencia computacional</strong>: Menor uso de memoria y procesamiento</li>
</ul>
<p><strong>Desventajas:</strong></p>
<ul>
<li><strong>Supuesto de intervalos uniformes</strong>: Asume que las diferencias entre niveles consecutivos son iguales</li>
<li><strong>Riesgo con variables no-ordinales</strong>: Puede imponer orden artificial en variables nominales</li>
<li><strong>Pérdida de flexibilidad</strong>: No puede capturar relaciones no-lineales entre niveles ordinales</li>
</ul>
</div>
</div>
</section>
<section id="comparación-directa-ordinal-vs-one-hot-encoding" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="comparación-directa-ordinal-vs-one-hot-encoding"><span class="header-section-number">4.5.4</span> Comparación directa: Ordinal vs One-Hot Encoding</h3>
<p>La elección entre codificación ordinal y one-hot encoding depende fundamentalmente de la naturaleza de la variable categórica y los objetivos del análisis. Una decisión incorrecta puede llevar a interpretaciones erróneas y modelos subóptimos.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 29%">
<col style="width: 38%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Característica</strong></th>
<th><strong>Codificación Ordinal</strong></th>
<th><strong>One-Hot Encoding</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Preserva el orden</strong></td>
<td>Sí, refleja la jerarquía entre categorías</td>
<td>No, trata cada categoría como independiente</td>
</tr>
<tr class="even">
<td><strong>Dimensionalidad</strong></td>
<td>Una sola columna</td>
<td>k columnas (o k-1)</td>
</tr>
<tr class="odd">
<td><strong>Adecuado para</strong></td>
<td>Variables con orden natural (educación, satisfacción)</td>
<td>Variables nominales (color, género, región)</td>
</tr>
<tr class="even">
<td><strong>Interpretación</strong></td>
<td>Cambio por unidad de nivel</td>
<td>Diferencia vs.&nbsp;categoría de referencia</td>
</tr>
<tr class="odd">
<td><strong>Eficiencia computacional</strong></td>
<td>Alta (menos parámetros)</td>
<td>Menor (más parámetros)</td>
</tr>
<tr class="even">
<td><strong>Riesgo principal</strong></td>
<td>Orden artificial en variables nominales</td>
<td>Dimensionalidad excesiva</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="interacciones-entre-variables" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="interacciones-entre-variables"><span class="header-section-number">4.6</span> Interacciones entre variables</h2>
<p>Las <strong>interacciones entre variables</strong> representan uno de los conceptos más poderosos y subestimados en el modelado estadístico. Mientras que los efectos principales capturan el impacto promedio de cada variable por separado, las interacciones revelan cómo el efecto de una variable cambia según el nivel de otra variable. Este fenómeno es omnipresente en el mundo real: el efecto del precio en las ventas depende del nivel de publicidad, el impacto de la experiencia en el salario varía según la educación, o la efectividad de un tratamiento médico puede diferir entre grupos demográficos.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Principios para feature engineering efectivo">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Principios para feature engineering efectivo
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Justificación teórica</strong>: Cada nueva variable debe tener sentido conceptual en el dominio</li>
<li><strong>Validación rigurosa</strong>: Evaluar el poder predictivo real en datos no vistos</li>
<li><strong>Simplicidad primero</strong>: Preferir transformaciones simples e interpretables</li>
<li><strong>Documentación exhaustiva</strong>: Registrar el proceso de creación y la lógica detrás de cada feature</li>
<li><strong>Monitoreo continuo</strong>: Verificar que las relaciones se mantienen en producción</li>
</ol>
</div>
</div>
<p>Ignorar las interacciones relevantes puede llevar a conclusiones erróneas y pérdida significativa de poder predictivo. Por otro lado, incluir interacciones irrelevantes incrementa la complejidad del modelo sin beneficios, violando el principio de parsimonia. La clave está en identificar, interpretar y validar interacciones de manera sistemática y teoricamente fundamentada.</p>
<section id="interacciones-entre-variables-continuas" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="interacciones-entre-variables-continuas"><span class="header-section-number">4.6.1</span> Interacciones entre variables continuas</h3>
<p>El caso más directo es la interacción entre dos variables continuas:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_1 X_2 + \varepsilon\]</span></p>
<p><strong>Interpretación del coeficiente de interacción</strong> (<span class="math inline">\(\beta_3\)</span>):</p>
<ul>
<li>Si <span class="math inline">\(\beta_3 &gt; 0\)</span>: El efecto de <span class="math inline">\(X_1\)</span> se amplifica cuando <span class="math inline">\(X_2\)</span> aumenta</li>
<li>Si $_3 &lt; 0: El efecto de <span class="math inline">\(X_1\)</span> se atenúa cuando <span class="math inline">\(X_2\)</span> aumenta</li>
<li>Si <span class="math inline">\(\beta_3 = 0\)</span>: No hay interacción (efectos aditivos)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Interacción precio-publicidad en ventas">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Interacción precio-publicidad en ventas
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación: efecto de precio y publicidad en ventas</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># con interacción (mayor publicidad reduce sensibilidad al precio)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>precio <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">50</span>, <span class="dv">150</span>)  <span class="co"># precio en euros</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>publicidad <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)  <span class="co"># gasto en publicidad (miles €)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Efecto principal negativo del precio, positivo de publicidad</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Interacción: mayor publicidad reduce sensibilidad negativa al precio</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>ventas <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="sc">-</span> <span class="dv">5</span><span class="sc">*</span>precio <span class="sc">+</span> <span class="dv">50</span><span class="sc">*</span>publicidad <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>precio<span class="sc">*</span>publicidad<span class="sc">/</span><span class="dv">10</span> <span class="sc">+</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>datos_inter <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(precio, publicidad, ventas)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con interacción</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>modelo_interaccion <span class="ot">&lt;-</span> <span class="fu">lm</span>(ventas <span class="sc">~</span> precio <span class="sc">*</span> publicidad, <span class="at">data =</span> datos_inter)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_interaccion)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ventas ~ precio * publicidad, data = datos_inter)

Residuals:
     Min       1Q   Median       3Q      Max 
-158.256  -35.577    0.296   37.460  118.605 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       968.37048   27.53011  35.175   &lt;2e-16 ***
precio             -4.74324    0.26860 -17.659   &lt;2e-16 ***
publicidad         55.77675    4.48175  12.445   &lt;2e-16 ***
precio:publicidad   0.03470    0.04432   0.783    0.435    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 50.87 on 196 degrees of freedom
Multiple R-squared:  0.9518,    Adjusted R-squared:  0.9511 
F-statistic:  1291 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Interpretación numérica de los coeficientes:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer coeficientes y p-valores para interpretación</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>coef_int <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo_interaccion)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>summary_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_interaccion)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>p_valores <span class="ot">&lt;-</span> summary_model<span class="sc">$</span>coefficients[, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla de interpretación de efectos</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>tabla_efectos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nivel_Publicidad =</span> <span class="fu">c</span>(<span class="st">"0 (sin publicidad)"</span>, <span class="st">"5 (media)"</span>, <span class="st">"10 (alta)"</span>),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Efecto_Precio =</span> <span class="fu">c</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(coef_int[<span class="dv">2</span>], <span class="dv">2</span>),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(coef_int[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>coef_int[<span class="dv">4</span>], <span class="dv">2</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(coef_int[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>coef_int[<span class="dv">4</span>], <span class="dv">2</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla_efectos, </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Efecto del precio según el nivel de publicidad (hipotético)"</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Nivel de Publicidad"</span>, <span class="st">"Efecto del Precio (€/unidad)"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Efecto del precio según el nivel de publicidad (hipotético)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Nivel de Publicidad</th>
<th style="text-align: right;">Efecto del Precio (€/unidad)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0 (sin publicidad)</td>
<td style="text-align: right;">-4.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">5 (media)</td>
<td style="text-align: right;">-4.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10 (alta)</td>
<td style="text-align: right;">-4.40</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Evidencia estadística:</strong> La interacción tiene un coeficiente de <strong>0.035</strong> con un p-valor de <strong>0.435</strong>. Dado que p &gt; 0.05, <strong>no hay evidencia estadística de interacción</strong> entre precio y publicidad.</p>
<p><strong>Interpretación del gráfico:</strong> El primer gráfico (scatter plot con líneas de tendencia por grupos de publicidad) muestra <strong>líneas prácticamente paralelas</strong>, confirmando la ausencia de interacción. Aunque visualmente las pendientes parecen ligeramente diferentes, esta variación está dentro del rango esperado por el ruido aleatorio.</p>
<p><strong>Implicaciones prácticas:</strong></p>
<ul>
<li>El efecto del precio sobre las ventas es <strong>constante</strong> (-€5 por unidad) independientemente del nivel de publicidad</li>
<li>Los efectos son <strong>aditivos</strong>: cada €1000 adicional en publicidad aumenta las ventas base en ~50 unidades, sin modificar la sensibilidad al precio</li>
<li><strong>Modelo recomendado:</strong> <code>ventas ~ precio + publicidad</code> (sin término de interacción)</li>
</ul>
<p><strong>Lección metodológica:</strong> Este caso demuestra la importancia de <strong>confiar en la evidencia estadística formal</strong> sobre las impresiones visuales cuando hay variabilidad muestral significativa.</p>
<p><strong>Visualización para verificar ausencia de interacción:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de la interacción</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear grupos de publicidad para visualizar</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>datos_inter<span class="sc">$</span>pub_grupo <span class="ot">&lt;-</span> <span class="fu">cut</span>(datos_inter<span class="sc">$</span>publicidad, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">breaks =</span> <span class="dv">3</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Baja"</span>, <span class="st">"Media"</span>, <span class="st">"Alta"</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_inter, <span class="fu">aes</span>(<span class="at">x =</span> precio, <span class="at">y =</span> ventas, <span class="at">color =</span> pub_grupo)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efectos Aditivos: Precio y Publicidad"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Pendientes similares confirman ausencia de interacción"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Precio (€)"</span>, <span class="at">y =</span> <span class="st">"Ventas"</span>, <span class="at">color =</span> <span class="st">"Publicidad"</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema3_files/figure-html/visualizacion-interaccion-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretación crítica: Visual vs Estadística</strong></p>
<p>Observando el gráfico, las líneas <strong>parecen tener pendientes diferentes</strong>, lo que visualmente sugeriría la presencia de interacción. Sin embargo, el análisis estadístico formal nos indica que esta diferencia <strong>no es estadísticamente significativa</strong> (p = 0.435).</p>
<p><strong>¿Por qué esta aparente contradicción?</strong></p>
<ul>
<li><strong>Variabilidad aleatoria</strong>: Las diferencias observadas pueden deberse al ruido aleatorio en los datos</li>
<li><strong>Tamaño de muestra</strong>: Puede no ser suficiente para detectar una interacción débil si realmente existe</li>
<li><strong>Poder estadístico</strong>: El test puede no tener suficiente poder para detectar efectos pequeños</li>
<li><strong>Agrupación artificial</strong>: Los grupos de publicidad se crearon artificialmente para visualización, no reflejan la variable continua real</li>
</ul>
<p><strong>Decisión metodológica correcta:</strong></p>
<ul>
<li><strong>Confiar en la estadística formal</strong>: El p-valor &gt; 0.05 indica no significancia</li>
<li><strong>Modelo parsimonioso</strong>: Eliminar el término de interacción no significativo</li>
<li><strong>Interpretación conservadora</strong>: Los efectos son aditivos hasta que se demuestre lo contrario</li>
</ul>
<p><strong>Lección crucial:</strong></p>
<p>Este ejemplo demuestra por qué <strong>la inspección visual nunca debe ser el único criterio</strong> para decidir sobre la inclusión de términos de interacción. La estadística inferencial formal debe prevalecer sobre las impresiones visuales, especialmente cuando hay incertidumbre debido a la variabilidad muestral.</p>
<p><strong>Modelo final recomendado:</strong> <code>ventas ~ precio + publicidad</code> (sin interacción)</p>
</div>
</div>
</div>
</section>
<section id="interacciones-entre-variables-categóricas" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="interacciones-entre-variables-categóricas"><span class="header-section-number">4.6.2</span> Interacciones entre variables categóricas</h3>
<p>Cuando ambas variables son categóricas, las interacciones representan efectos específicos de combinaciones de categorías que no pueden explicarse por los efectos principales por separado.</p>
<p>Para dos variables categóricas A (con niveles i) y B (con niveles j), el modelo incluye:</p>
<p><span class="math display">\[Y = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \varepsilon\]</span></p>
<p>Donde <span class="math inline">\((\alpha\beta)_{ij}\)</span> representa la interacción específica entre el nivel i de A y el nivel j de B.</p>
<p>La interacción <span class="math inline">\((\alpha\beta)_{ij}\)</span> indica cuánto la combinación específica (i,j) se desvía del efecto que esperaríamos si solo sumáramos los efectos principales <span class="math inline">\(\alpha_i + \beta_j\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Interacción género-departamento en salarios">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Interacción género-departamento en salarios
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación: salarios por género y departamento con interacción</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (brecha salarial varía según departamento)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables categóricas</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>genero <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Masculino"</span>, <span class="st">"Femenino"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>departamento <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Ventas"</span>, <span class="st">"IT"</span>, <span class="st">"RRHH"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Efectos principales y de interacción simulados</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>efecto_base <span class="ot">&lt;-</span> <span class="dv">40000</span>  <span class="co"># salario base</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>efecto_masculino <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(genero <span class="sc">==</span> <span class="st">"Masculino"</span>, <span class="dv">2000</span>, <span class="dv">0</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>efecto_it <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(departamento <span class="sc">==</span> <span class="st">"IT"</span>, <span class="dv">8000</span>, <span class="dv">0</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>efecto_rrhh <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(departamento <span class="sc">==</span> <span class="st">"RRHH"</span>, <span class="dv">3000</span>, <span class="dv">0</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Interacción: brecha de género mayor en IT</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>interaccion <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(genero <span class="sc">==</span> <span class="st">"Masculino"</span> <span class="sc">&amp;</span> departamento <span class="sc">==</span> <span class="st">"IT"</span>, <span class="dv">4000</span>, <span class="dv">0</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>salario <span class="ot">&lt;-</span> efecto_base <span class="sc">+</span> efecto_masculino <span class="sc">+</span> efecto_it <span class="sc">+</span> efecto_rrhh <span class="sc">+</span> </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>           interaccion <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3000</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>datos_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(genero, departamento, salario)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con interacción</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>modelo_cat <span class="ot">&lt;-</span> <span class="fu">lm</span>(salario <span class="sc">~</span> genero <span class="sc">*</span> departamento, <span class="at">data =</span> datos_cat)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_cat)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = salario ~ genero * departamento, data = datos_cat)

Residuals:
    Min      1Q  Median      3Q     Max 
-8037.9 -1930.7    48.4  1968.1  7486.9 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         47627.4      461.2 103.270  &lt; 2e-16 ***
generoMasculino                      6166.3      593.4  10.391  &lt; 2e-16 ***
departamentoRRHH                    -4433.3      633.9  -6.994 1.80e-11 ***
departamentoVentas                  -7744.7      597.4 -12.964  &lt; 2e-16 ***
generoMasculino:departamentoRRHH    -4007.2      857.1  -4.675 4.48e-06 ***
generoMasculino:departamentoVentas  -3793.8      814.4  -4.659 4.83e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2917 on 294 degrees of freedom
Multiple R-squared:  0.7372,    Adjusted R-squared:  0.7327 
F-statistic: 164.9 on 5 and 294 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Medias por grupo para interpretar la interacción</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>medias_grupo <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(salario <span class="sc">~</span> genero <span class="sc">+</span> departamento, <span class="at">data =</span> datos_cat, <span class="at">FUN =</span> mean)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>medias_grupo <span class="ot">&lt;-</span> medias_grupo[<span class="fu">order</span>(medias_grupo<span class="sc">$</span>departamento, medias_grupo<span class="sc">$</span>genero), ]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(medias_grupo, <span class="at">caption =</span> <span class="st">"Salario promedio por género y departamento"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Salario promedio por género y departamento</caption>
<thead>
<tr class="header">
<th style="text-align: left;">genero</th>
<th style="text-align: left;">departamento</th>
<th style="text-align: right;">salario</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Femenino</td>
<td style="text-align: left;">IT</td>
<td style="text-align: right;">47627.44</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masculino</td>
<td style="text-align: left;">IT</td>
<td style="text-align: right;">53793.71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Femenino</td>
<td style="text-align: left;">RRHH</td>
<td style="text-align: right;">43194.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masculino</td>
<td style="text-align: left;">RRHH</td>
<td style="text-align: right;">45353.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Femenino</td>
<td style="text-align: left;">Ventas</td>
<td style="text-align: right;">39882.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masculino</td>
<td style="text-align: left;">Ventas</td>
<td style="text-align: right;">42255.23</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de la interacción</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> departamento, <span class="at">y =</span> salario, <span class="at">fill =</span> genero)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interacción Género-Departamento en Salarios"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Departamento"</span>, <span class="at">y =</span> <span class="st">"Salario (€)"</span>, <span class="at">fill =</span> <span class="st">"Género"</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema3_files/figure-html/interaccion-categorica-categorica-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Evidencia visual clara:</strong> El segundo gráfico (boxplots por género y departamento) revela <strong>patrones de interacción marcados</strong> que se manifiestan de forma diferente en cada departamento.</p>
<p><strong>Patrones específicos por departamento:</strong></p>
<ul>
<li><strong>IT:</strong> La brecha de género es <strong>máxima</strong> (~€8,000). Los hombres tienen salarios significativamente superiores y mayor variabilidad salarial</li>
<li><strong>RRHH:</strong> Brecha <strong>moderada</strong> (~€3,000) con distribuciones más similares entre géneros</li>
<li><strong>Ventas:</strong> <strong>Menor brecha de género</strong> (~€1,500), con salarios más homogéneos entre grupos</li>
</ul>
<p><strong>Interpretación de la interacción:</strong> Las <strong>líneas no paralelas</strong> en el patrón de medias confirman que el efecto del género sobre el salario <strong>varía significativamente según el departamento</strong>. Esto sugiere:</p>
<ul>
<li>Diferencias en <strong>culturas departamentales</strong> respecto a equidad salarial</li>
<li><strong>Estructuras de compensación</strong> variables entre departamentos</li>
<li>Posibles diferencias en <strong>poder de negociación</strong> o <strong>demanda de talento</strong></li>
</ul>
<p><strong>Implicaciones organizacionales:</strong> La interacción indica que las políticas salariales no son uniformes y que intervenciones de equidad deberían ser <strong>diferenciadas por departamento</strong>.</p>
<p><strong>Gráfico de interacción clásico:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular medias y errores estándar por grupo para el gráfico</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(dplyr))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>medias_se <span class="ot">&lt;-</span> datos_cat <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genero, departamento) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">media =</span> <span class="fu">mean</span>(salario),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(salario) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los datos calculados</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(medias_se, <span class="at">caption =</span> <span class="st">"Medias y errores estándar por grupo"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Medias y errores estándar por grupo</caption>
<thead>
<tr class="header">
<th style="text-align: left;">genero</th>
<th style="text-align: left;">departamento</th>
<th style="text-align: right;">media</th>
<th style="text-align: right;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Femenino</td>
<td style="text-align: left;">IT</td>
<td style="text-align: right;">47627.44</td>
<td style="text-align: right;">463.4703</td>
</tr>
<tr class="even">
<td style="text-align: left;">Femenino</td>
<td style="text-align: left;">RRHH</td>
<td style="text-align: right;">43194.15</td>
<td style="text-align: right;">443.9292</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Femenino</td>
<td style="text-align: left;">Ventas</td>
<td style="text-align: right;">39882.76</td>
<td style="text-align: right;">378.5932</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masculino</td>
<td style="text-align: left;">IT</td>
<td style="text-align: right;">53793.71</td>
<td style="text-align: right;">371.1923</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Masculino</td>
<td style="text-align: left;">RRHH</td>
<td style="text-align: right;">45353.23</td>
<td style="text-align: right;">425.9146</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masculino</td>
<td style="text-align: left;">Ventas</td>
<td style="text-align: right;">42255.23</td>
<td style="text-align: right;">414.4745</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de interacción estilo clásico</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(medias_se, <span class="fu">aes</span>(<span class="at">x =</span> departamento, <span class="at">y =</span> media, <span class="at">color =</span> genero, <span class="at">group =</span> genero)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> media <span class="sc">-</span> se, <span class="at">ymax =</span> media <span class="sc">+</span> se), <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Gráfico de Interacción: Género × Departamento"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Las líneas no paralelas indican presencia de interacción"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Departamento"</span>, <span class="at">y =</span> <span class="st">"Salario promedio (€)"</span>, <span class="at">color =</span> <span class="st">"Género"</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema3_files/figure-html/grafico-interaccion-viz-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretación del gráfico:</strong> Las líneas <strong>no son paralelas</strong>, confirmando la presencia de interacción significativa. La brecha salarial de género varía considerablemente: mayor en IT, moderada en RRHH, y menor en Ventas.</p>
</div>
</div>
</div>
</section>
<section id="interacciones-mixtas-continua-categórica" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="interacciones-mixtas-continua-categórica"><span class="header-section-number">4.6.3</span> Interacciones mixtas (continua × categórica)</h3>
<p>Las interacciones mixtas son especialmente útiles para modelar cómo el efecto de una variable continua varía entre grupos categóricos. Esto es fundamental cuando sospechamos que la relación funcional cambia según el contexto definido por la variable categórica.</p>
<p><strong>Formulación matemática:</strong> <span class="math display">\[Y = \beta_0 + \beta_1 X + \beta_2 D + \beta_3 X \cdot D + \varepsilon\]</span></p>
<p>Donde D es una variable dummy (0/1) que representa la variable categórica.</p>
<p><strong>Interpretación geométrica:</strong> La interacción permite que cada grupo categórico tenga:</p>
<ul>
<li><strong>Intercepto diferente</strong>: <span class="math inline">\(\beta_0\)</span> (grupo de referencia) vs.&nbsp;<span class="math inline">\(\beta_0 + \beta_2\)</span> (otro grupo)<br>
</li>
<li><strong>Pendiente diferente</strong>: <span class="math inline">\(\beta_1\)</span> (grupo de referencia) vs.&nbsp;<span class="math inline">\(\beta_1 + \beta_3\)</span> (otro grupo)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Interacción experiencia-género en salarios">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Interacción experiencia-género en salarios
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación: efecto de experiencia en salario varía según género</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>experiencia <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)  <span class="co"># años de experiencia</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>genero <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Femenino"</span>, <span class="st">"Masculino"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Efecto diferencial: pendiente de experiencia menor para mujeres</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>salario_base <span class="ot">&lt;-</span> <span class="dv">35000</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>efecto_experiencia_hombres <span class="ot">&lt;-</span> <span class="dv">2000</span>  <span class="co"># €2000 por año para hombres</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>efecto_experiencia_mujeres <span class="ot">&lt;-</span> <span class="dv">1200</span>  <span class="co"># €1200 por año para mujeres (brecha creciente)</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>efecto_genero_base <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(genero <span class="sc">==</span> <span class="st">"Masculino"</span>, <span class="dv">3000</span>, <span class="dv">0</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear variable dummy para interacción</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>dummy_masculino <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(genero <span class="sc">==</span> <span class="st">"Masculino"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Salario con interacción</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>salario <span class="ot">&lt;-</span> salario_base <span class="sc">+</span> </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>           efecto_experiencia_mujeres <span class="sc">*</span> experiencia <span class="sc">+</span>  <span class="co"># pendiente base (mujeres)</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>           efecto_genero_base <span class="sc">*</span> dummy_masculino <span class="sc">+</span>      <span class="co"># diferencia intercepto</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>           (efecto_experiencia_hombres <span class="sc">-</span> efecto_experiencia_mujeres) <span class="sc">*</span> experiencia <span class="sc">*</span> dummy_masculino <span class="sc">+</span>  <span class="co"># interacción</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">4000</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>datos_mixta <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(experiencia, genero, salario, dummy_masculino)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con interacción</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>modelo_mixta <span class="ot">&lt;-</span> <span class="fu">lm</span>(salario <span class="sc">~</span> experiencia <span class="sc">*</span> genero, <span class="at">data =</span> datos_mixta)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_mixta)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = salario ~ experiencia * genero, data = datos_mixta)

Residuals:
     Min       1Q   Median       3Q      Max 
-12340.2  -2742.7    162.8   2586.6   9293.8 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 35650.27     765.04  46.599   &lt;2e-16 ***
experiencia                  1123.03      69.74  16.103   &lt;2e-16 ***
generoMasculino              2613.33    1038.08   2.517   0.0125 *  
experiencia:generoMasculino   905.46      92.44   9.795   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3995 on 246 degrees of freedom
Multiple R-squared:  0.8889,    Adjusted R-squared:  0.8876 
F-statistic: 656.2 on 3 and 246 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Interpretación detallada de los coeficientes:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer coeficientes para interpretación</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>coef_mixta <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo_mixta)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla de interpretación por género</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>tabla_genero <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  Parámetro <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Intercepto (salario inicial)"</span>, <span class="st">"Pendiente (€ por año experiencia)"</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mujeres =</span> <span class="fu">c</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"€"</span>, <span class="fu">format</span>(<span class="fu">round</span>(coef_mixta[<span class="dv">1</span>], <span class="dv">0</span>), <span class="at">big.mark =</span> <span class="st">","</span>)),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"€"</span>, <span class="fu">round</span>(coef_mixta[<span class="dv">2</span>], <span class="dv">0</span>))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Hombres =</span> <span class="fu">c</span>(</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"€"</span>, <span class="fu">format</span>(<span class="fu">round</span>(coef_mixta[<span class="dv">1</span>] <span class="sc">+</span> coef_mixta[<span class="dv">3</span>], <span class="dv">0</span>), <span class="at">big.mark =</span> <span class="st">","</span>)),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"€"</span>, <span class="fu">round</span>(coef_mixta[<span class="dv">2</span>] <span class="sc">+</span> coef_mixta[<span class="dv">4</span>], <span class="dv">0</span>))</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Diferencia =</span> <span class="fu">c</span>(</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"€"</span>, <span class="fu">format</span>(<span class="fu">round</span>(coef_mixta[<span class="dv">3</span>], <span class="dv">0</span>), <span class="at">big.mark =</span> <span class="st">","</span>)),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"€"</span>, <span class="fu">round</span>(coef_mixta[<span class="dv">4</span>], <span class="dv">0</span>), <span class="st">" adicionales"</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla_genero, </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Comparación de parámetros del modelo por género"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparación de parámetros del modelo por género</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parámetro</th>
<th style="text-align: left;">Mujeres</th>
<th style="text-align: left;">Hombres</th>
<th style="text-align: left;">Diferencia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercepto (salario inicial)</td>
<td style="text-align: left;">€35,650</td>
<td style="text-align: left;">€38,264</td>
<td style="text-align: left;">€2,613</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pendiente (€ por año experiencia)</td>
<td style="text-align: left;">€1123</td>
<td style="text-align: left;">€2028</td>
<td style="text-align: left;">€905 adicionales</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Implicaciones de la interacción:</strong></p>
<p>El coeficiente de interacción (<strong>905</strong>) indica que cada año adicional de experiencia aumenta el salario masculino en <strong>€905 más</strong> que el salario femenino. Esto crea una <strong>brecha creciente</strong>: inicialmente la diferencia es de €2,613, pero después de 20 años de experiencia, la brecha total alcanza €20,722.</p>
<p><strong>Visualización de la divergencia salarial:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de líneas de regresión por grupo</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_mixta, <span class="fu">aes</span>(<span class="at">x =</span> experiencia, <span class="at">y =</span> salario, <span class="at">color =</span> genero)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interacción Experiencia-Género: Brechas Crecientes"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"La brecha salarial se amplía con la experiencia"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Años de experiencia"</span>, <span class="at">y =</span> <span class="st">"Salario (€)"</span>, <span class="at">color =</span> <span class="st">"Género"</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Femenino"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>, <span class="st">"Masculino"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(<span class="at">suffix =</span> <span class="st">"€"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema3_files/figure-html/visualizacion-mixta-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Evidencia de brechas crecientes:</strong> El tercer gráfico (scatter plot con líneas de regresión) demuestra claramente el patrón de <strong>interacción experiencia-género</strong> mediante <strong>líneas divergentes</strong> con pendientes notablemente diferentes.</p>
<p><strong>Interpretación cuantitativa de la divergencia:</strong></p>
<ul>
<li><strong>Punto de inicio (0 años):</strong> Brecha inicial de €2,613 a favor de los hombres</li>
<li><strong>Pendientes diferenciadas:</strong> Los hombres ganan €2028 adicionales por año vs.&nbsp;€1123 para las mujeres</li>
<li><strong>Brecha acumulativa:</strong> Cada año adicional de experiencia <strong>amplía la brecha</strong> en €905 adicionales</li>
</ul>
<p><strong>Implicaciones del patrón de interacción:</strong> La <strong>divergencia progresiva</strong> visible en las líneas revela que:</p>
<ul>
<li>El <strong>retorno a la experiencia</strong> es sistemáticamente <strong>mayor para hombres</strong> que para mujeres</li>
<li>A los 20 años de experiencia, la brecha total alcanza €20,722 (inicial + acumulativa)</li>
<li>Este patrón sugiere <strong>barreras estructurales</strong> que impiden que las mujeres capitalicen plenamente su experiencia</li>
</ul>
<p><strong>Significancia social:</strong> Esta interacción documenta un fenómeno preocupante donde la <strong>inequidad salarial se agrava con el tiempo</strong>, indicando que las brechas de género no son meramente diferencias de entrada sino <strong>desventajas acumulativas</strong> a lo largo de la carrera profesional.</p>
</div>
</div>
</div>
</section>
<section id="identificación-y-detección-de-interacciones" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="identificación-y-detección-de-interacciones"><span class="header-section-number">4.6.4</span> Identificación y detección de interacciones</h3>
<p>La detección sistemática de interacciones requiere combinar justificación teórica, exploración visual y validación estadística. No debemos buscar interacciones aleatoriamente, sino guiados por el conocimiento del dominio y patrones observables en los datos.</p>
<p>La justificación teórica previa es fundamental: la teoría del dominio debe sugerir dónde pueden existir interacciones. Por ejemplo, en economía esperamos efectos precio-publicidad o educación-experiencia; en medicina son comunes las interacciones dosis-edad o tratamiento-comorbilidad; en marketing encontramos interacciones producto-canal o temporada-promoción.</p>
<p>La exploración visual sistemática complementa la teoría con evidencia empírica. Para variables continuas utilizamos gráficos de dispersión coloreados por grupos categóricos; para variables categóricas empleamos gráficos de interacción (interaction plots); para interacciones mixtas analizamos líneas de regresión por grupo.</p>
<p>Los tests estadísticos formales proporcionan validación objetiva: el test F para interacciones compara modelos con y sin términos de interacción, el test de significancia individual evalúa coeficientes específicos mediante t-test, y los criterios de información (AIC/BIC) guían la selección entre modelos alternativos.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Estrategia de modelado jerárquico">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estrategia de modelado jerárquico
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Principio de jerarquía:</strong> Si incluimos una interacción A×B, siempre debemos incluir los efectos principales A y B, incluso si no son significativos individualmente. Esto preserva la interpretabilidad y evita sesgos en los coeficientes de interacción.</p>
<p><strong>Proceso de construcción del modelo:</strong></p>
<ol type="1">
<li><strong>Modelo base</strong>: Solo efectos principales</li>
<li><strong>Modelo con interacciones</strong>: Agregar términos de interacción teoricamente justificados</li>
<li><strong>Comparación</strong>: Test F para evaluar mejora significativa</li>
<li><strong>Selección</strong>: Usar criterios estadísticos y de parsimonia</li>
<li><strong>Validación</strong>: Verificar supuestos y estabilidad en datos de prueba</li>
</ol>
</div>
</div>
</section>
<section id="consideraciones-prácticas-y-limitaciones" class="level3" data-number="4.6.5">
<h3 data-number="4.6.5" class="anchored" data-anchor-id="consideraciones-prácticas-y-limitaciones"><span class="header-section-number">4.6.5</span> Consideraciones prácticas y limitaciones</h3>
<p>Las interacciones incrementan exponencialmente la complejidad interpretativa del modelo. Un modelo con k efectos principales puede tener hasta <span class="math inline">\(k(k-1)/2\)</span> interacciones de segundo orden, y el número crece exponencialmente con interacciones de orden superior. Esta explosión combinatorial hace que incluso modelos aparentemente simples se vuelvan rápidamente inmanejables desde el punto de vista interpretativo. Como reglas prácticas para la complejidad, recomendamos limitar a máximo 2-3 interacciones de segundo orden en modelos explicativos, evitar interacciones de tercer orden salvo justificación teórica muy sólida, y priorizar interacciones con efectos grandes sobre mera significancia estadística.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Advertencia sobre interpretación">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advertencia sobre interpretación
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Cuidado con la interpretación automática.</strong> Las interacciones en escalas transformadas tienen significados diferentes que en escalas originales. Siempre verificar la interpretación en el contexto de la transformación aplicada y considerar la retransformación para comunicación con audiencias no técnicas.</p>
</div>
</div>
<p>Un problema adicional surge cuando las interacciones crean multicolinealidad severa, especialmente cuando las variables principales están correlacionadas, se incluyen múltiples interacciones con variables comunes, o se usan variables categóricas con muchos niveles. Esta multicolinealidad puede hacer que los coeficientes individuales sean inestables y difíciles de interpretar, incluso cuando el modelo en conjunto funcione bien predictivamente. Las estrategias de mitigación incluyen el centrado de variables continuas para reducir la correlación entre X y X×Z, la selección cuidadosa de interacciones sin incluir todas las combinaciones posibles, y el uso de métodos de regularización como Ridge o Lasso cuando hay múltiples interacciones.</p>
<p>La situación se complica aún más cuando las variables están transformadas (logarítmica, Box-Cox). En estos casos, la interpretación de las interacciones adquiere significados completamente diferentes que en escalas originales. Por ejemplo, en un modelo como <span class="math inline">\(\log(Y) = \beta_0 + \beta_1 \log(X_1) + \beta_2 X_2 + \beta_3 \log(X_1) \cdot X_2 + \varepsilon\)</span>, el coeficiente <span class="math inline">\(\beta_3\)</span> representa cómo cambia la elasticidad de Y respecto a X₁ cuando X₂ aumenta en una unidad, lo que requiere una interpretación mucho más sofisticada que una interacción en escalas lineales.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Principios para el uso de interacciones">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Principios para el uso de interacciones
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Justificación teórica primero</strong>: No buscar interacciones sin base conceptual</li>
<li><strong>Principio de jerarquía</strong>: Mantener efectos principales cuando se incluyen interacciones</li>
<li><strong>Parsimonia</strong>: Preferir modelos simples que expliquen bien sobre modelos complejos</li>
<li><strong>Validación robusta</strong>: Verificar estabilidad en múltiples contextos</li>
<li><strong>Interpretación cuidadosa</strong>: Asegurar comprensión completa antes de conclusiones</li>
<li><strong>Comunicación efectiva</strong>: Usar visualizaciones para explicar efectos complejos</li>
</ol>
</div>
</div>
<p>Las interacciones son herramientas poderosas que pueden revelar patrones importantes ocultos en los efectos principales. Sin embargo, su uso requiere disciplina metodológica, justificación teórica sólida, y validación rigurosa para evitar conclusiones espurias y modelos sobreajustados.</p>
</section>
</section>
<section id="ingeniería-de-características-avanzada-combinaciones-ratios-y-transformaciones" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="ingeniería-de-características-avanzada-combinaciones-ratios-y-transformaciones"><span class="header-section-number">4.7</span> Ingeniería de características avanzada: combinaciones, ratios y transformaciones</h2>
<p>Más allá de las transformaciones individuales e interacciones, la ingeniería de características avanzada implica crear nuevas variables predictivas mediante combinaciones matemáticas, ratios y transformaciones compuestas que capturen relaciones complejas no evidentes en las variables originales <span class="citation" data-cites="kuhn2019feature">(<a href="references.html#ref-kuhn2019feature" role="doc-biblioref">Kuhn y Johnson 2019</a>)</span>. Esta aproximación es fundamental cuando las variables individuales contienen información parcial que, al combinarse, revelan patrones predictivos más potentes.</p>
<section id="combinaciones-lineales-y-no-lineales" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="combinaciones-lineales-y-no-lineales"><span class="header-section-number">4.7.1</span> Combinaciones lineales y no lineales</h3>
<p>Las combinaciones lineales crean nuevas variables mediante sumas ponderadas de variables existentes, útiles especialmente cuando trabajamos con variables que miden aspectos relacionados del mismo fenómeno pero con diferentes escalas o unidades.</p>
<p><strong>Ejemplos de combinaciones lineales efectivas:</strong></p>
<ul>
<li><p><strong>Índices compuestos</strong>: Combinan múltiples indicadores en un score único que captura un constructo multidimensional. Por ejemplo, un índice de riesgo cardiovascular podría definirse como <code>índice_salud = 0.4×presión_arterial_normalizada + 0.3×colesterol_normalizada + 0.3×IMC_normalizado</code>. Los pesos (0.4, 0.3, 0.3) reflejan la importancia relativa establecida por evidencia médica, creando una métrica integrada que es más informativa que cualquier indicador individual. Este tipo de índices son especialmente valiosos en dominios donde múltiples factores contribuyen conjuntamente al outcome de interés.</p></li>
<li><p><strong>Scores balanceados</strong>: Representan equilibrios o trade-offs entre dimensiones competitivas. Un ejemplo típico es <code>balance_trabajo_vida = horas_trabajo / (tiempo_personal + tiempo_familia + tiempo_descanso)</code>. Esta métrica captura no solo la intensidad laboral, sino también su contexto relativo dentro del estilo de vida completo. Valores altos indican desbalance hacia el trabajo, mientras que valores cercanos a 1.0 sugieren equilibrio saludable. Los scores balanceados son fundamentales para capturar dinámicas de compensación que no son evidentes en variables absolutas.</p></li>
<li><p><strong>Factores sintéticos</strong>: Cuando múltiples variables correlacionadas miden aspectos del mismo constructo subyacente, pueden condensarse en un factor común que preserve la información esencial eliminando redundancia. Por ejemplo, si tenemos variables <code>ingresos</code>, <code>educación</code>, y <code>prestigio_ocupacional</code> (todas correlacionadas), podemos crear un factor <code>estatus_socioeconomico</code> que capture la varianza común. Esto es especialmente útil cuando la colinealidad entre predictores compromete la estabilidad del modelo, pero cada variable aporta información valiosa.</p></li>
</ul>
<p>Las combinaciones no lineales van más allá de las sumas ponderadas para capturar interacciones multiplicativas, sinergias y compensaciones entre variables mediante productos, cocientes, potencias y funciones más complejas:</p>
<ul>
<li><p><strong>Productos de eficiencia</strong>: Capturan sinergias multiplicativas donde el rendimiento depende de la combinación simultánea de múltiples factores. Por ejemplo, <code>rendimiento_efectivo = capacidad_instalada × utilización_porcentual × factor_calidad</code>. Esta métrica reconoce que el rendimiento real no es aditivo: tener alta capacidad pero baja utilización, o alta utilización con problemas de calidad, resulta en rendimiento subóptimo. Los productos de eficiencia son esenciales en contextos operacionales donde el desempeño emerge de la coordinación entre recursos.</p></li>
<li><p><strong>Ratios de rendimiento ajustado por riesgo</strong>: Normalizan beneficios por su costo o riesgo asociado, creando métricas comparables entre contextos diferentes. Un ejemplo financiero sería <code>eficiencia_ajustada = (rendimiento_esperado - tasa_libre_riesgo) / (volatilidad + costos_transaccion)</code>. Esta formulación reconoce que los rendimientos absolutos son engañosos sin considerar el riesgo asumido y los costos incurridos. Los ratios ajustados son cruciales para decisiones de optimización donde debemos comparar alternativas con perfiles de riesgo-retorno heterogéneos.</p></li>
<li><p><strong>Funciones de utilidad</strong>: Capturan percepciones subjetivas o valores no lineales mediante transformaciones que reflejan preferencias reales. Por ejemplo, <code>valor_percibido = √(calidad_producto) × precio⁻⁰·⁵</code> reconoce que la utilidad del consumidor tiene rendimientos decrecientes tanto en calidad como en ahorro de precio. La raíz cuadrada de la calidad refleja que mejoras incrementales tienen menor impacto en niveles altos, mientras que el exponente negativo del precio captura la sensibilidad decreciente a cambios de precio en productos caros.</p></li>
</ul>
</section>
<section id="ratios-y-proporciones-como-features" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" class="anchored" data-anchor-id="ratios-y-proporciones-como-features"><span class="header-section-number">4.7.2</span> Ratios y proporciones como features</h3>
<p>Los ratios son especialmente poderosos porque normalizan automáticamente las diferencias de escala y pueden revelar relaciones proporcionales fundamentales que permanecen ocultas en variables absolutas. A diferencia de las medidas absolutas, los ratios capturan relaciones estructurales que son invariantes bajo cambios de escala y contexto, lo que los convierte en herramientas fundamentales para crear features robustos y comparables.</p>
<p>La potencia de los ratios radica en su capacidad para transformar información absoluta en información relativa. Por ejemplo, una empresa con €1M en ventas y €100K en marketing tiene un ratio ventas/marketing de 10, igual que una empresa con €10M en ventas y €1M en marketing. Esta normalización automática permite comparaciones directas y elimina sesgos de tamaño que podrían distorsionar el análisis.</p>
<p><strong>Categorización detallada de ratios efectivos:</strong></p>
<ol type="1">
<li><p><strong>Ratios de eficiencia</strong>: Miden qué tan efectivamente se convierten los inputs en outputs, revelando productividad y optimización operacional. Ejemplos fundamentales incluyen:</p>
<ul>
<li><code>ROI_marketing = (ventas_generadas - gasto_marketing) / gasto_marketing</code>: Captura el retorno neto por euro invertido</li>
<li><code>eficiencia_produccion = unidades_producidas / (horas_trabajo + costo_materiales)</code>: Normaliza productividad por recursos consumidos</li>
<li><code>conversion_rate = ventas_completadas / visitantes_web</code>: Revela la efectividad del funnel de conversión</li>
</ul>
<p>Estos ratios son especialmente valiosos porque eliminan el efecto escala y permiten comparar unidades de diferentes tamaños en términos de eficiencia pura.</p></li>
<li><p><strong>Ratios de riesgo ajustado</strong>: Normalizan retornos o beneficios por la incertidumbre o costo asociado, proporcionando métricas de valor ajustado por riesgo:</p>
<ul>
<li><code>sharpe_ratio = (rendimiento_promedio - tasa_libre_riesgo) / volatilidad</code>: Mide retorno por unidad de riesgo asumido</li>
<li><code>stability_score = beneficio_promedio / desviacion_estandar_beneficios</code>: Indica consistencia en el desempeño</li>
<li><code>risk_adjusted_growth = crecimiento_promedio / max_drawdown</code>: Captura crecimiento sostenible</li>
</ul>
<p>Estos ratios son cruciales en análisis financiero y gestión de riesgos, donde los valores absolutos pueden ser engañosos sin considerar la variabilidad subyacente.</p></li>
<li><p><strong>Ratios temporales</strong>: Capturan dinámicas y tendencias mediante comparaciones entre períodos, revelando momentum y patrones estacionales:</p>
<ul>
<li><code>momentum_growth = crecimiento_último_trimestre / crecimiento_promedio_histórico</code>: Identifica aceleración o desaceleración</li>
<li><code>estacionalidad = ventas_período_actual / media_móvil_12_meses</code>: Captura variaciones cíclicas</li>
<li><code>trend_strength = (valor_actual - valor_hace_12_meses) / volatilidad_histórica</code>: Mide significancia de cambios</li>
</ul>
<p>Estos ratios son especialmente útiles en análisis de series temporales donde necesitamos distinguir entre variación normal y cambios estructurales significativos.</p></li>
<li><p><strong>Ratios de composición</strong>: Revelan la estructura interna de agregados mediante proporciones parte-todo, fundamentales para análisis de portafolios y segmentación:</p>
<ul>
<li><code>concentracion_cliente = ventas_top3_clientes / ventas_totales</code>: Mide dependencia y riesgo de concentración</li>
<li><code>diversificacion_producto = 1 - suma(proportion_i²)</code>: Índice de Herfindahl para medir dispersión</li>
<li><code>market_share = ventas_empresa / ventas_mercado_total</code>: Posición relativa competitiva</li>
</ul>
<p>Los ratios de composición son esenciales para gestión de riesgos y análisis estratégico, revelando vulnerabilidades y fortalezas estructurales.</p></li>
</ol>
<p><strong>Ventajas metodológicas profundizadas:</strong></p>
<ul>
<li><p><strong>Normalización automática</strong>: Los ratios eliminan efectos de escala absoluta, haciendo comparables entidades de diferentes tamaños. Una startup con €10K en ventas y €2K en marketing tiene el mismo ratio ventas/marketing (5.0) que una multinacional con €100M y €20M respectivamente, permitiendo benchmarking directo de eficiencia.</p></li>
<li><p><strong>Interpretación intuitiva</strong>: Los ratios tienen significados naturales que facilitan la comunicación con stakeholders. Un ratio deuda/patrimonio de 0.3 es inmediatamente comprensible como “30 céntimos de deuda por cada euro de patrimonio”, mientras que valores absolutos requieren más contexto.</p></li>
<li><p><strong>Robustez ante outliers</strong>: Los ratios suelen ser menos sensibles a valores extremos que las variables absolutas. Si una empresa tiene ventas anómalamente altas pero también marketing proporcionalmente alto, el ratio ventas/marketing permanece estable, mientras que ambas variables individuales serían outliers.</p></li>
<li><p><strong>Invarianza bajo transformaciones</strong>: Los ratios mantienen sus relaciones bajo cambios de unidades o inflación. El ratio precio/ingresos de una acción es el mismo si se mide en euros o dólares, proporcionando estabilidad interpretativa a lo largo del tiempo y contextos.</p></li>
</ul>
<p><strong>Consideraciones para construcción robusta de ratios:</strong></p>
<p>Los ratios requieren cuidado especial en su construcción para evitar interpretaciones erróneas o inestabilidad numérica. Es fundamental evitar denominadores cercanos a cero, considerar transformaciones logarítmicas para ratios con rangos amplios, y validar que el ratio tenga significado conceptual en el dominio de aplicación.</p>
</section>
<section id="tratamiento-de-variables-colineales-mediante-feature-engineering" class="level3" data-number="4.7.3">
<h3 data-number="4.7.3" class="anchored" data-anchor-id="tratamiento-de-variables-colineales-mediante-feature-engineering"><span class="header-section-number">4.7.3</span> Tratamiento de variables colineales mediante feature engineering</h3>
<p>Cuando enfrentamos multicolinealidad entre predictores informativos, la ingeniería de características ofrece alternativas más sofisticadas que simplemente eliminar variables o usar interacciones sin efectos principales. Este escenario es común en la práctica: tenemos múltiples variables que aportan información valiosa individualmente, pero están suficientemente correlacionadas como para crear problemas de estabilidad e interpretación en el modelo.</p>
<p>El enfoque tradicional de “eliminar variables correlacionadas” es problemático porque puede resultar en pérdida significativa de información predictiva. Si <code>variable_A</code> y <code>variable_B</code> tienen correlación r = 0.75, ambas comparten 56% de varianza, pero cada una retiene 44% de información única. Eliminar cualquiera de ellas descarta información potencialmente valiosa que podría mejorar el poder predictivo del modelo.</p>
<p>La ingeniería de características para colinealidad busca condensar la información redundante mientras preserva la información única, creando nuevas variables que capturen la esencia predictiva de las variables originales sin los problemas de multicolinealidad. Esta aproximación es especialmente valiosa cuando la correlación entre variables tiene significado teórico: por ejemplo, diferentes medidas de solvencia financiera que capturan aspectos relacionados pero distintos del riesgo crediticio.</p>
<p><strong>Estrategias avanzadas de condensación de información:</strong></p>
<ol type="1">
<li><p><strong>Componentes principales (PCA)</strong>: Extraen direcciones de máxima varianza común, creando variables ortogonales que preservan la mayor cantidad de información con la menor dimensionalidad:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo: Variables financieras correlacionadas</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>pc_financiero <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="sc">~</span> ingresos <span class="sc">+</span> patrimonio <span class="sc">+</span> crédito <span class="sc">+</span> liquidez, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>score_financiero <span class="ot">&lt;-</span> pc_financiero<span class="sc">$</span>x[,<span class="dv">1</span>]  <span class="co"># Primer componente (mayor varianza)</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>score_diversificacion <span class="ot">&lt;-</span> pc_financiero<span class="sc">$</span>x[,<span class="dv">2</span>]  <span class="co"># Segundo componente (varianza residual)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ventajas del PCA: Elimina completamente la multicolinealidad, preserva máxima varianza, proporciona interpretación de “factores latentes”. Desventajas: Pérdida de interpretabilidad directa, todos los componentes dependen de todas las variables originales, sensible a outliers.</p></li>
<li><p><strong>Ratios informativos</strong>: Crean cocientes que preservan la información relativa más relevante, eliminando efectos de escala común:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ratios que capturan relaciones estructurales fundamentales</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ratio_debt_income <span class="ot">&lt;-</span> deuda_total <span class="sc">/</span> ingresos_anuales  <span class="co"># Capacidad de endeudamiento</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ratio_assets_equity <span class="ot">&lt;-</span> activos <span class="sc">/</span> patrimonio_neto     <span class="co"># Apalancamiento</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ratio_liquidity <span class="ot">&lt;-</span> activos_liquidos <span class="sc">/</span> pasivos_corrientes  <span class="co"># Solvencia a corto plazo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ventajas de los ratios: Mantienen interpretabilidad económica directa, eliminan efectos de escala, capturan relaciones estructurales clave. Aplicabilidad: Especialmente efectivos cuando las variables correlacionadas miden aspectos del mismo fenómeno subyacente (ej. diferentes medidas de tamaño empresarial).</p></li>
<li><p><strong>Índices ponderados</strong>: Combinan variables usando pesos derivados de conocimiento teórico o empírico, creando métricas compuestas más robustas que sus componentes individuales:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Índice de solvencia con pesos basados en evidencia empírica</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>indice_solvencia <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="sc">*</span> (ingresos<span class="sc">/</span>gastos) <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> (activos<span class="sc">/</span>deudas) <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> score_crediticio_normalizado</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Índice de crecimiento balanceado</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>indice_crecimiento <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> crecimiento_ventas <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> crecimiento_beneficios <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> crecimiento_empleados</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Determinación de pesos: Pueden derivarse de análisis factorial confirmatorio, regresión ridge, conocimiento experto, o optimización empírica. Los pesos deben justificarse teóricamente y validarse en datos independientes.</p></li>
<li><p><strong>Diferencias y cambios relativos</strong>: Capturan dinámicas temporales y patrones de co-movimiento que revelan información única no presente en niveles absolutos:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dinámicas de crecimiento relativo</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>crecimiento_relativo <span class="ot">&lt;-</span> (valor_actual <span class="sc">-</span> valor_anterior) <span class="sc">/</span> valor_anterior</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>aceleracion <span class="ot">&lt;-</span> (crecimiento_t <span class="sc">-</span> crecimiento_t_1) <span class="sc">/</span> crecimiento_t_1</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Medidas de estabilidad y volatilidad</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>volatilidad <span class="ot">&lt;-</span> <span class="fu">sd</span>(ultimos_12_meses) <span class="sc">/</span> <span class="fu">mean</span>(ultimos_12_meses)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>consistencia <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">cv</span>(ultimos_periodos))  <span class="co"># Coeficiente de variación invertido</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Aplicabilidad temporal: Especialmente útiles para series temporales donde variables están correlacionadas en niveles pero divergen en tasas de cambio, revelando dinámicas diferenciales ocultas en análisis de niveles.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Criterios de selección de estrategia
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>PCA</strong>: Cuando la interpretabilidad no es crítica y maximizar la retención de varianza es prioritario</li>
<li><strong>Ratios</strong>: Cuando existe significado teórico claro en las relaciones proporcionales entre variables</li>
<li><strong>Índices ponderados</strong>: Cuando hay conocimiento previo sobre la importancia relativa de cada componente</li>
<li><strong>Cambios relativos</strong>: Cuando las dinámicas temporales son más informativas que los niveles absolutos</li>
</ul>
</div>
</div>
<p>La ingeniería de características es tanto arte como ciencia: requiere creatividad para identificar combinaciones útiles, pero también rigor metodológico para validar que las nuevas variables realmente aportan valor predictivo estable y generalizable.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-box1964analysis" class="csl-entry" role="listitem">
Box, George EP, y David R Cox. 1964. <span>«An analysis of transformations»</span>. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 26 (2): 211-43.
</div>
<div id="ref-carroll1988transformation" class="csl-entry" role="listitem">
Carroll, Raymond J, y David Ruppert. 1988. <span>«Transformation and weighting in regression»</span>. <em>Monographs on Statistics and Applied Probability</em>.
</div>
<div id="ref-jaccard2003interaction" class="csl-entry" role="listitem">
Jaccard, James, y Robert Turrisi. 2003. <em>Interaction effects in multiple regression</em>. Sage.
</div>
<div id="ref-kuhn2019feature" class="csl-entry" role="listitem">
Kuhn, Max, y Kjell Johnson. 2019. <em>Feature engineering and selection: a practical approach for predictive models</em>. CRC Press.
</div>
<div id="ref-potdar2017comparative" class="csl-entry" role="listitem">
Potdar, Kedar, Taher S Pardawala, y Chinmay D Pai. 2017. <span>«A comparative study of categorical variable encoding techniques for neural network classifiers»</span>. <em>International journal of computer applications</em> 175 (4): 7-9.
</div>
<div id="ref-yeo2000new" class="csl-entry" role="listitem">
Yeo, In-Kwon, y Richard A Johnson. 2000. <span>«A new family of power transformations to improve normality or symmetry»</span>. <em>Biometrika</em> 87 (4): 954-59.
</div>
<div id="ref-zheng2018feature" class="csl-entry" role="listitem">
Zheng, Alice, y Amanda Casari. 2018. <em>Feature engineering for machine learning: principles and techniques for data scientists</em>. O’Reilly Media.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./tema2.html" class="pagination-link" aria-label="El modelo de regresión lineal múltiple">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">El modelo de regresión lineal múltiple</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./tema4.html" class="pagination-link" aria-label="Selección de variables, regularización y validación">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Selección de variables, regularización y validación</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>